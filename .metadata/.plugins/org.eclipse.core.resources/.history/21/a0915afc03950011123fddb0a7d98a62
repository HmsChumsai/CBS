//DO NOT MODIFY  Extact Collateral Contract|ZBCONVCN||||||ZCONTRACT|||100|32000||0|||10|10|0||0||0
---------- REVHIST ------ Section marker

---------- OPEN    ------ Section marker
	kill ^TMP("ZRPT4")
	kill ^TMP("ZCONVCNT")
	kill ^TMP("ZCONVCOL")
---------- SCHINIT ------ Section marker

---------- SCHEXEC ------ Section marker

---------- SCHPOST ------ Section marker

---------- SCHEXIT ------ Section marker

---------- THRINIT ------ Section marker

---------- THREXEC ------ Section marker

---------- EXEC    ------ Section marker

	
	
	type RecordZCONTRACT zcnt = Db.getRecord("ZCONTRACT","CTRCT=:CTRCT")
	type RecordTMPRPT2 ext = Class.new("RecordTMPRPT2")
	type RecordTMPRPT2 ext2 = Class.new("RecordTMPRPT2")
	set ZTAB=$C(9)
	set ZENTER=$C(13)
	set ZPROBLEM=$C(10)
	//Extract ALL
		set ext.PID = "ZCONVCNT"
		set ext.KEY1 = zcnt.ctrct
		set ext.KEY2 = 0
	
			set ZDATA1.piece("|",1)= zcnt.BOO
			set ZDATA1.piece("|",2) = zcnt.CC
			set ZDATA1.piece("|",3) = zcnt.CONTRREL
			set ZDATA1.piece("|",4) = zcnt.CONVDT.toString("YEAR-MM-DD")
			if zcnt.CRTDATE'=0,zcnt.CRTDATE'="" set ZDATA1.piece("|",5) = zcnt.CRTDATE.toString("YEAR-MM-DD")_"-00.00.00"
			set ZDATA1.piece("|",6) = zcnt.CRTUSER
			set ZDATA1.piece("|",7) = zcnt.CTRCT
			if zcnt.CTRCTDT'=0,zcnt.CTRCTDT'="" set ZDATA1.piece("|",8) = zcnt.CTRCTDT.toString("YEAR-MM-DD")_"-00.00.00"
			set ZDATA1.piece("|",9) = zcnt.CTRSTAT
			set ZDATA1.piece("|",10) = zcnt.MCTRCT
			set ZDATA1.piece("|",11) = zcnt.PLDGAMT
			set ZDATA1.piece("|",12) = zcnt.PLDGSEQ
			if zcnt.RELDATE'=0,zcnt.RELDATE'="" set ZDATA1.piece("|",13) = zcnt.RELDATE.toString("YEAR-MM-DD")_"-00.00.00"
			set ZDATA1.piece("|",14) = zcnt.REMARKS
			set ZDATA1.piece("|",15) = zcnt.RESPUNIT
			
			if ZDATA1[ZENTER  set ZDATA1=$TR(ZDATA1,ZENTER," ")
			if ZDATA1[ZTAB    set ZDATA1=$TR(ZDATA1,ZTAB," ")
			if ZDATA1[ZPROBLEM set ZDATA1=$TR(ZDATA1,ZPROBLEM," ")
			if ZDATA1[$C(34) set ZDATA1=$TR(ZDATA1,$C(34)," ")
			
		set ext.DATA=ZDATA1
		do ext.bypassSave()
	
	if zcnt.CTRSTAT=0 do {
		set ext2.PID = "ZCONVCNT"
		set ext2.KEY1 = zcnt.ctrct
		set ext2.KEY2 = 1
		set ext2.DATA=ZDATA1
		do ext2.bypassSave()
		
								
		type ResultSet rs = Db.select("COLL","zctrctcol","ZCTRCTCOL.CTRCT=:zcnt.ctrct")	
		while rs.next() do {			
			new ZDETAIL
			set ZRSCOL = rs.getCol(1)	
			type RecordZCOL zcol = Db.getRecord("ZCOL","COLL=:ZRSCOL")
			type RecordTMPRPT1 extcol = Class.new("RecordTMPRPT1")
			set extcol.PID = "ZCONVCOL"
			set extcol.KEY1 = zcol.COLL		
			set ZDATA=""
			set ZDATA.piece("|",1) = zcol.AMPHUR
			set ZDATA.piece("|",2) = zcol.AO
			set ZDATA.piece("|",3) = zcol.APDCODE
			set ZDATA.piece("|",4) = zcol.APPBOO
			set ZDATA.piece("|",5) = zcol.APPBY
			set ZDATA.piece("|",6) = zcol.APPDT.toString("YEAR-MM-DD")
			set ZDATA.piece("|",7) = zcol.APPOFF1
			set ZDATA.piece("|",8) = zcol.APPOFF2
			set ZDATA.piece("|",9) = zcol.APPOFF3
			set ZDATA.piece("|",10) = zcol.APPTID
			set ZDATA.piece("|",11) = zcol.APPVAL
			set ZDATA.piece("|",12) = zcol.ASDATE.toString("YEAR-MM-DD")
			set ZDATA.piece("|",13) = zcol.BKNUMBER
			set ZDATA.piece("|",14) = zcol.BLASTID
			set ZDATA.piece("|",15) = zcol.BLDCODE
			set ZDATA.piece("|",16) = zcol.BLDNAME
			set ZDATA.piece("|",17) = zcol.BLDNUM
			set ZDATA.piece("|",18) = zcol.BLDTYPE
			set ZDATA.piece("|",19) = zcol.BLDVAL
			set ZDATA.piece("|",20) = zcol.BOO
			set ZDATA.piece("|",21) = zcol.BOOTFR
			set ZDATA.piece("|",22) = zcol.BOTCODE
			set ZDATA.piece("|",23) = zcol.BOTRSKRT
			set ZDATA.piece("|",24) = zcol.BSOI
			set ZDATA.piece("|",25) = zcol.BSTRTID
			set ZDATA.piece("|",26) = zcol.BUILDNO
			set ZDATA.piece("|",27) = zcol.CACN
			set ZDATA.piece("|",28) = zcol.CC
			set ZDATA.piece("|",29) = zcol.CCRDT.toString("YEAR-MM-DD")
			set ZDATA.piece("|",30) = zcol.CCRNUM
			set ZDATA.piece("|",31) = zcol.CERNO
			set ZDATA.piece("|",32) = zcol.CID
			set ZDATA.piece("|",33) = zcol.CMDCD
			set ZDATA.piece("|",34) = zcol.COLL
			set ZDATA.piece("|",35) = zcol.COLSUBT
			set ZDATA.piece("|",36) = zcol.COLTYP
			set ZDATA.piece("|",37) = zcol.CONDPAR
			set ZDATA.piece("|",38) = zcol.CONVDT.toString("YEAR-MM-DD")
			set ZDATA.piece("|",39) = zcol.CRCD
			set ZDATA.piece("|",40) = zcol.DATETRF.toString("YEAR-MM-DD")
			set ZDATA.piece("|",41) = zcol.DESC
			set ZDATA.piece("|",42) = zcol.DOB.toString("YEAR-MM-DD")
			set ZDATA.piece("|",43) = zcol.DOCLCT
			set ZDATA.piece("|",44) = zcol.DOD.toString("YEAR-MM-DD")
			set ZDATA.piece("|",45) = zcol.ENGCAP
			set ZDATA.piece("|",46) = zcol.EXTRSKR
			set ZDATA.piece("|",47) = zcol.FLOOR
			set ZDATA.piece("|",48) = zcol.GRPNO
			set ZDATA.piece("|",49)	= zcol.GTEL
			set ZDATA.piece("|",50) = zcol.INSREQ
			set ZDATA.piece("|",51) = zcol.KTBRKR
			set ZDATA.piece("|",52) = zcol.LNDINFO
			set ZDATA.piece("|",53) = zcol.LNDNO
			set ZDATA.piece("|",54) = zcol.LNDVAL
			set ZDATA.piece("|",55) = zcol.LNDVOL1
			set ZDATA.piece("|",56) = zcol.LNDVOL2
			set ZDATA.piece("|",57) = zcol.LNDVOL3
			set ZDATA.piece("|",58) = zcol.LNDVOL4
			set ZDATA.piece("|",59) = zcol.LOC1
			set ZDATA.piece("|",60) = zcol.LOC2
			set ZDATA.piece("|",61) = zcol.LOC3
			set ZDATA.piece("|",62) = zcol.LQCD
			set ZDATA.piece("|",63) = zcol.LRTRVDT.toString("YEAR-MM-DD")
			set ZDATA.piece("|",64) = zcol.MCODE1
			set ZDATA.piece("|",65) = zcol.MCODE2
			set ZDATA.piece("|",66) = zcol.NONCRM
			set ZDATA.piece("|",67) = zcol.OPRIMKEY
			set ZDATA.piece("|",68) = zcol.OWNLNDVOL1
			set ZDATA.piece("|",69) = zcol.OWNLNDVOL2
			set ZDATA.piece("|",70) = zcol.OWNLNDVOL3
			set ZDATA.piece("|",71) = zcol.OWNLNDVOL4
			set ZDATA.piece("|",72) = zcol.OWNPORTN
			set ZDATA.piece("|",73) = zcol.PACN
			set ZDATA.piece("|",74) = zcol.PAGENO
			set ZDATA.piece("|",75) = zcol.PARTLFLG
			set ZDATA.piece("|",76) = zcol.PAYPARTY
			set ZDATA.piece("|",77) = zcol.PCHPRICE
			set ZDATA.piece("|",78) = zcol.PCOLVAL
			set ZDATA.piece("|",79) = zcol.PERSONID
			set ZDATA.piece("|",80) = zcol.PROVINCE
			set ZDATA.piece("|",81) = zcol.RAVANG
			set ZDATA.piece("|",82) = zcol.REASON
			set ZDATA.piece("|",83) = zcol.REMARKS
			set ZDATA.piece("|",84) = zcol.RESPUNIT
			set ZDATA.piece("|",85) = zcol.RIGHBAL
			set ZDATA.piece("|",86) = zcol.RIGHVAL
			set ZDATA.piece("|",87) = zcol.RMAREA
			set ZDATA.piece("|",88) = zcol.RMKPORTN
			set ZDATA.piece("|",89) = zcol.RMNUMBER
			set ZDATA.piece("|",90) = zcol.ROAD
			set ZDATA.piece("|",91) = zcol.RSCD
			set ZDATA.piece("|",92) = zcol.RULCOST
			set ZDATA.piece("|",93) = zcol.SEQNO
			set ZDATA.piece("|",94) = zcol.SHRHLDRG
			set ZDATA.piece("|",95) = zcol.SHRTNAME
			set ZDATA.piece("|",96) = zcol.STCKNO
			set ZDATA.piece("|",97) = zcol.STOREY
			set ZDATA.piece("|",98) = zcol.SUBBOT
			set ZDATA.piece("|",99) = zcol.SYMBOL
			set ZDATA.piece("|",100) = zcol.TAMBOL
			set ZDATA.piece("|",101) = zcol.TOTPORTN
			set ZDATA.piece("|",102) = zcol.UNITCD
			set ZDATA.piece("|",103) = zcol.USEDSTDT.toString("YEAR-MM-DD")
			set ZDATA.piece("|",104) = zcol.USEFULIF
			set ZDATA.piece("|",105) = zcol.ZATEEXP.toString("YEAR-MM-DD")
			set ZDATA.piece("|",106) = zcol.ZATEISSUEDT.toString("YEAR-MM-DD")
			set ZDATA.piece("|",107) = zcol.ZATEISSUER
			set ZDATA.piece("|",108) = zcol.ZATENUM
			set ZDATA.piece("|",109) = zcol.ZCERTBAL
			set ZDATA.piece("|",110) = zcol.ZCERTCID
			set ZDATA.piece("|",111) = zcol.ZCERTGRP
			set ZDATA.piece("|",112) = zcol.ZCERTID
			set ZDATA.piece("|",113) = zcol.ZCERTLOTH
			set ZDATA.piece("|",114) = zcol.ZCERTLOTL
			set ZDATA.piece("|",115) = zcol.ZCERTPERIOD
			set ZDATA.piece("|",116) = zcol.ZCERTUNIT
			set ZDATA.piece("|",117) = zcol.ZLGISSUEDT.toString("YEAR-MM-DD")
			set ZDATA.piece("|",118) = zcol.ZLGNUM
			set ZDATA.piece("|",119) = zcol.ZRADUR
			set ZDATA.piece("|",120) = zcol.ZRAEXP.toString("YEAR-MM-DD")
			set ZDATA.piece("|",121) = zcol.ZRAISSUER
			set ZDATA.piece("|",122) = zcol.ZRANUM
			set ZDATA.piece("|",123) = zcol.ZRATYPE	
			
			if ZDATA[ZENTER  set ZDATA=$TR(ZDATA,ZENTER," ")
			if ZDATA[ZTAB    set ZDATA=$TR(ZDATA,ZTAB," ")
			if ZDATA[ZPROBLEM set ZDATA=$TR(ZDATA,ZPROBLEM," ")
			if ZDATA[$C(34) set ZDATA=$TR(ZDATA,$C(34)," ")
			
			set extcol.DATA = ZDATA
			do extcol.bypassSave()
			
			//For Report CBSRPT4
			set ZBOO		= zcol.BOO
			set ZCOLTYP		= zcol.COLTYP
			set ZCOLSUBT		= zcol.COLSUBT
			set APPRAISEDBY 	= zcol.APPBY
			set APPRAISEDDT 	= zcol.APPDT.toString("YEAR-MM-DD")
			set APPRAISALVAL 	= zcol.APPVAL
			set ZDETAIL		= ""
					
		
			set (ZBRNAME,ZCOLTYPDES,ZSUBBOTDES,ZCOLSUBDESC)="N/A"
			
		
			if Db.isDefined("UTBLBRCD","BRCD=:ZBOO") do {
				type RecordUTBLBRCD zbr = Db.getRecord("UTBLBRCD","BRCD=:ZBOO")
				set ZBRNAME = zbr.desc
			}
			if Db.isDefined("ZUTBLCOLTYP","COLCD=:ZCOLTYP") do {
				type RecordZUTBLCOLTYP coldesc = Db.getRecord("ZUTBLCOLTYP","COLCD=:ZCOLTYP")  
				set ZCOLTYPDESC=coldesc.desc
			}
			if Db.isDefined("ZUTBLCOLSUBT","COLCD=:ZCOLTYP,COLSUBT=:ZCOLSUBT") do {
				type RecordZUTBLCOLSUBT colsubdesc = Db.getRecord("ZUTBLCOLSUBT","COLCD=:ZCOLTYP,COLSUBT=:ZCOLSUBT")
				set ZCOLSUBDESC = colsubdesc.desc
			}
				
			if ZCOLTYP=1 do {
				
				set ZDETAIL.piece("|",1) = zcol.LRTRVDT  
				set ZDETAIL.piece("|",2) = zcol.GRPNO 
				set ZDETAIL.piece("|",3) = zcol.AMPHUR 
				set ZDETAIL.piece("|",4) = zcol.BKNUMBER 
				set ZDETAIL.piece("|",5) = zcol.PARTLFLG  
				set ZDETAIL.piece("|",6) = zcol.LNDNO
				set ZDETAIL.piece("|",7) = zcol.LNDVOL1
				set ZDETAIL.piece("|",8) = zcol.LNDVOL2 
				set ZDETAIL.piece("|",9) = zcol.LNDVOL3
				set ZDETAIL.piece("|",10) = zcol.LNDVOL4   
				set ZDETAIL.piece("|",11) = zcol.LOC1
				set ZDETAIL.piece("|",12) = zcol.LOC2       
				set ZDETAIL.piece("|",13) = zcol.LOC3
				set ZDETAIL.piece("|",14) = zcol.OWNPORTN   
				set ZDETAIL.piece("|",15) = zcol.OWNLNDVOL1 
				set ZDETAIL.piece("|",16) = zcol.OWNLNDVOL2 
				set ZDETAIL.piece("|",17) = zcol.OWNLNDVOL3 
				set ZDETAIL.piece("|",18) = zcol.OWNLNDVOL4 
				set ZDETAIL.piece("|",19) = zcol.PAGENO  
				set ZDETAIL.piece("|",20) = zcol.CONDPAR  
				set ZDETAIL.piece("|",21) = zcol.RMKPORTN   
				set ZDETAIL.piece("|",22) = zcol.PROVINCE
				set ZDETAIL.piece("|",23) = zcol.RAVANG
				set ZDETAIL.piece("|",24) = zcol.SEQNO   
				set ZDETAIL.piece("|",25) = zcol.TAMBOL 
				set ZDETAIL.piece("|",26) = zcol.TOTPORTN
				set ZDETAIL.piece("|",27) = zcol.LNDINFO
				set ZDETAIL.piece("|",28) = zcol.PROVINCE
				set ZDETAIL.piece("|",29) = zcol.ROAD
				set ZDETAIL.piece("|",30) = zcol.BSOI
				set ZDETAIL.piece("|",31) = zcol.TAMBOL  
				set ZDETAIL.piece("|",32) = zcol.BLDCODE 
				set ZDETAIL.piece("|",33) = zcol.BLDNAME  
				set ZDETAIL.piece("|",34) = zcol.BLDNUM 
				set ZDETAIL.piece("|",35) = zcol.BUILDNO  
				set ZDETAIL.piece("|",36) = zcol.RMNUMBER
				set ZDETAIL.piece("|",37) = zcol.STOREY
				set ZDETAIL.piece("|",38) = zcol.RMAREA
				
				set ^TMP("ZRPT4",1,zcol.coll) = ZBOO_"|"_ZBRNAME_"|"_ZCOLTYP_"|"_ZCOLTYPDES_"|"_ZCOLSUBT_"|"_ZCOLSUBDESC_"|"_zcol.coll_"|"_ZDETAIL
			}
		
			if (ZCOLTYP=2)!(ZCOLTYP=8) do {
				
				set ZDETAIL.piece("|",1) = zcol.LNDINFO
				set ZDETAIL.piece("|",2) = zcol.PROVINCE
				set ZDETAIL.piece("|",3) = zcol.ROAD
				set ZDETAIL.piece("|",4) = zcol.BSOI
				set ZDETAIL.piece("|",5) = zcol.TAMBOL 
				set ZDETAIL.piece("|",6) = zcol.BLDCODE
				set ZDETAIL.piece("|",7) = zcol.BLDNAME
				set ZDETAIL.piece("|",8) = zcol.BLDNUM 
				set ZDETAIL.piece("|",9) = zcol.BUILDNO
				set ZDETAIL.piece("|",10) = zcol.RMNUMBER 
				set ZDETAIL.piece("|",11) = zcol.STOREY 
				set ZDETAIL.piece("|",12) = zcol.RMAREA 
				set ^TMP("ZRPT4",2,zcol.coll) = ZBOO_"|"_ZBRNAME_"|"_ZCOLTYP_"|"_ZCOLTYPDES_"|"_ZCOLSUBT_"|"_ZCOLSUBDESC_"|"_zcol.coll_"|"_ZDETAIL
			}
			
			if (ZCOLTYP=3)!(ZCOLTYP=10) do {
				
				set ZDETAIL.piece("|",1) = zcol.AMPHUR
				set ZDETAIL.piece("|",2) = zcol.ENGCAP
				set ZDETAIL.piece("|",3) = zcol.MCODE1
				set ZDETAIL.piece("|",4) = zcol.MCODE2
				set ZDETAIL.piece("|",5) = zcol.UNITCD
				set ZDETAIL.piece("|",6) = zcol.USEDSTDT
				set ZDETAIL.piece("|",7) = zcol.PROVINCE.toString("DD/MM/YEAR")
				set ZDETAIL.piece("|",8) = zcol.ROAD 
				set ZDETAIL.piece("|",9) = zcol.BSOI
				set ZDETAIL.piece("|",10) = zcol.TAMBOL 
				set ^TMP("ZRPT4",3,zcol.coll) = ZBOO_"|"_ZBRNAME_"|"_ZCOLTYP_"|"_ZCOLTYPDES_"|"_ZCOLSUBT_"|"_ZCOLSUBDESC_"|"_zcol.coll_"|"_ZDETAIL
			}
			if ZCOLTYP=4 do {
				
				set ZDETAIL.piece("|",1)=zcol.CID 
				set ^TMP("ZRPT4",4,zcol.coll) = ZBOO_"|"_ZBRNAME_"|"_ZCOLTYP_"|"_ZCOLTYPDES_"|"_ZCOLSUBT_"|"_ZCOLSUBDESC_"|"_zcol.coll_"|"_ZDETAIL
			}
			if ZCOLTYP=8 do {
		
				set ZDETAIL.piece("|",1) = zcol.PROVINCE
				set ZDETAIL.piece("|",2) = zcol.ROAD
				set ZDETAIL.piece("|",3) = zcol.BSOI
				set ZDETAIL.piece("|",4) = zcol.TAMBOL 
				set ZDETAIL.piece("|",5) = zcol.BLDCODE
				set ZDETAIL.piece("|",6) = zcol.BLDNAME
				set ZDETAIL.piece("|",7) = zcol.BLDNUM 
				set ZDETAIL.piece("|",8) = zcol.BUILDNO
				set ZDETAIL.piece("|",9) = zcol.RMNUMBER 
				set ZDETAIL.piece("|",10) = zcol.STOREY 
				set ZDETAIL.piece("|",11) = zcol.RMAREA 
				
				set ^TMP("ZRPT4",5,zcol.coll) = ZBOO_"|"_ZBRNAME_"|"_ZCOLTYP_"|"_ZCOLTYPDES_"|"_ZCOLSUBT_"|"_ZCOLSUBDESC_"|"_zcol.coll_"|"_ZDETAIL
			}
			if (ZCOLTYP=5)!(ZCOLTYP=6) do {
		
				set ZDETAIL.piece("|",1) = zcol.BLASTID
				set ZDETAIL.piece("|",2) = zcol.BSTRTID
				set ZDETAIL.piece("|",3) = zcol.SHRHLDRG
				
				set ^TMP("ZRPT4",6,zcol.coll) = ZBOO_"|"_ZBRNAME_"|"_ZCOLTYP_"|"_ZCOLTYPDES_"|"_ZCOLSUBT_"|"_ZCOLSUBDESC_"|"_zcol.coll_"|"_ZDETAIL			}
			
			if ZCOLTYP=7 do {
		
				set ZDETAIL.piece("|",1) = zcol.GTEL
				set ZDETAIL.piece("|",2) = zcol.CACN
				set ZDETAIL.piece("|",3) = zcol.PACN
				
				set ^TMP("ZRPT4",7,zcol.coll) = ZBOO_"|"_ZBRNAME_"|"_ZCOLTYP_"|"_ZCOLTYPDES_"|"_ZCOLSUBT_"|"_ZCOLSUBDESC_"|"_zcol.coll_"|"_ZDETAIL
			}
			
			if (ZCOLTYP=11)!(ZCOLTYP=12)!(ZCOLTYP=9)!(ZCOLTYP=13) do {
				
				set ZDETAIL.piece("|",1) = zcol.AMPHUR	
				set ZDETAIL.piece("|",2) = zcol.PROVINCE
				set ZDETAIL.piece("|",3) = zcol.ROAD
				set ZDETAIL.piece("|",4) = zcol.BSOI
				set ZDETAIL.piece("|",5) = zcol.TAMBOL 
				set ZDETAIL.piece("|",6) = zcol.RIGHBAL
				set ZDETAIL.piece("|",7) = zcol.ZLGNUM
				set ZDETAIL.piece("|",8) = zcol.ZATEISSUER 
				set ZDETAIL.piece("|",9) = zcol.ZLGISSUEDT
				set ZDETAIL.piece("|",10) = zcol.ZATEEXP 
				set ZDETAIL.piece("|",11) = zcol.ZATEISSUEDT 
				set ZDETAIL.piece("|",12) = zcol.ZATENUM
				set ZDETAIL.piece("|",13) = zcol.ZRAEXP
				set ZDETAIL.piece("|",14) = zcol.ZRAISSUER
				set ZDETAIL.piece("|",15) = zcol.ZRANUM
				set ZDETAIL.piece("|",16) = zcol.ZRATYPE
				set ZDETAIL.piece("|",17) = zcol.ASDATE
				set ZDETAIL.piece("|",18) = zcol.CCRDT
				set ZDETAIL.piece("|",19) = zcol.CCRNUM
				set ZDETAIL.piece("|",20) = zcol.PAYPARTY
				set ZDETAIL.piece("|",21) = zcol.RIGHVAL
				set ZDETAIL.piece("|",22) = zcol.BOOTFR
				set ZDETAIL.piece("|",23) = zcol.DATETRF
				
				set ^TMP("ZRPT4",8,zcol.coll) = ZBOO_"|"_ZBRNAME_"|"_ZCOLTYP_"|"_ZCOLTYPDES_"|"_ZCOLSUBT_"|"_ZCOLSUBDESC_"|"_zcol.coll_"|"_ZDETAIL
			}
			if ZCOLTYP=14 do {
		
				set ZDETAIL.piece("|",1) = zcol.CID
				set ZDETAIL.piece("|",2) = zcol.ZCERTID
				set ZDETAIL.piece("|",3) = zcol.ZCERTCID
				set ZDETAIL.piece("|",4) = zcol.ZCERTBAL
				set ZDETAIL.piece("|",5) = zcol.ZCERTGRP
				set ZDETAIL.piece("|",6) = zcol.ZCERTLOTH
				set ZDETAIL.piece("|",7) = zcol.ZCERTLOTL
				set ZDETAIL.piece("|",8) = zcol.ZCERTPERIOD
				set ZDETAIL.piece("|",9) = zcol.ZCERTUNIT
				
				set ^TMP("ZRPT4",9,zcol.coll) = ZBOO_"|"_ZBRNAME_"|"_ZCOLTYP_"|"_ZCOLTYPDES_"|"_ZCOLSUBT_"|"_ZCOLSUBDESC_"|"_zcol.coll_"|"_ZDETAIL
	
			}
			
			
		}
	}
	
	if zcnt.CTRSTAT=1 do {
		type ResultSet rs = Db.select("COLL","zctrctcol","ZCTRCTCOL.CTRCT=:zcnt.ctrct")			
		while rs.next() do {			
			set ZRSCOL = rs.getCol(1)	
			type RecordZCOL zcol = Db.getRecord("ZCOL","COLL=:ZRSCOL")
			if (zcol.coltyp=1)!(zcol.coltyp=2)!(zcol.coltyp=8)!(zcol.coltyp=11) do {				
				type RecordTMPRPT1 extcol = Class.new("RecordTMPRPT1")
				set extcol.PID = "ZCONVCOL"
				set extcol.KEY1 = zcol.COLL
				set ZDATA=""	
				set ZDATA.piece("|",1) = zcol.AMPHUR
				set ZDATA.piece("|",2) = zcol.AO
				set ZDATA.piece("|",3) = zcol.APDCODE
				set ZDATA.piece("|",4) = zcol.APPBOO
				set ZDATA.piece("|",5) = zcol.APPBY
				set ZDATA.piece("|",6) = zcol.APPDT.toString("YEAR-MM-DD")
				set ZDATA.piece("|",7) = zcol.APPOFF1
				set ZDATA.piece("|",8) = zcol.APPOFF2
				set ZDATA.piece("|",9) = zcol.APPOFF3
				set ZDATA.piece("|",10) = zcol.APPTID
				set ZDATA.piece("|",11) = zcol.APPVAL
				set ZDATA.piece("|",12) = zcol.ASDATE.toString("YEAR-MM-DD")
				set ZDATA.piece("|",13) = zcol.BKNUMBER
				set ZDATA.piece("|",14) = zcol.BLASTID
				set ZDATA.piece("|",15) = zcol.BLDCODE
				set ZDATA.piece("|",16) = zcol.BLDNAME
				set ZDATA.piece("|",17) = zcol.BLDNUM
				set ZDATA.piece("|",18) = zcol.BLDTYPE
				set ZDATA.piece("|",19) = zcol.BLDVAL
				set ZDATA.piece("|",20) = zcol.BOO
				set ZDATA.piece("|",21) = zcol.BOOTFR
				set ZDATA.piece("|",22) = zcol.BOTCODE
				set ZDATA.piece("|",23) = zcol.BOTRSKRT
				set ZDATA.piece("|",24) = zcol.BSOI
				set ZDATA.piece("|",25) = zcol.BSTRTID
				set ZDATA.piece("|",26) = zcol.BUILDNO
				set ZDATA.piece("|",27) = zcol.CACN
				set ZDATA.piece("|",28) = zcol.CC
				set ZDATA.piece("|",29) = zcol.CCRDT.toString("YEAR-MM-DD")
				set ZDATA.piece("|",30) = zcol.CCRNUM
				set ZDATA.piece("|",31) = zcol.CERNO
				set ZDATA.piece("|",32) = zcol.CID
				set ZDATA.piece("|",33) = zcol.CMDCD
				set ZDATA.piece("|",34) = zcol.COLL
				set ZDATA.piece("|",35) = zcol.COLSUBT
				set ZDATA.piece("|",36) = zcol.COLTYP
				set ZDATA.piece("|",37) = zcol.CONDPAR
				set ZDATA.piece("|",38) = zcol.CONVDT.toString("YEAR-MM-DD")
				set ZDATA.piece("|",39) = zcol.CRCD
				set ZDATA.piece("|",40) = zcol.DATETRF.toString("YEAR-MM-DD")
				set ZDATA.piece("|",41) = zcol.DESC
				set ZDATA.piece("|",42) = zcol.DOB.toString("YEAR-MM-DD")
				set ZDATA.piece("|",43) = zcol.DOCLCT
				set ZDATA.piece("|",44) = zcol.DOD.toString("YEAR-MM-DD")
				set ZDATA.piece("|",45) = zcol.ENGCAP
				set ZDATA.piece("|",46) = zcol.EXTRSKR
				set ZDATA.piece("|",47) = zcol.FLOOR
				set ZDATA.piece("|",48) = zcol.GRPNO
				set ZDATA.piece("|",49)	= zcol.GTEL
				set ZDATA.piece("|",50) = zcol.INSREQ
				set ZDATA.piece("|",51) = zcol.KTBRKR
				set ZDATA.piece("|",52) = zcol.LNDINFO
				set ZDATA.piece("|",53) = zcol.LNDNO
				set ZDATA.piece("|",54) = zcol.LNDVAL
				set ZDATA.piece("|",55) = zcol.LNDVOL1
				set ZDATA.piece("|",56) = zcol.LNDVOL2
				set ZDATA.piece("|",57) = zcol.LNDVOL3
				set ZDATA.piece("|",58) = zcol.LNDVOL4
				set ZDATA.piece("|",59) = zcol.LOC1
				set ZDATA.piece("|",60) = zcol.LOC2
				set ZDATA.piece("|",61) = zcol.LOC3
				set ZDATA.piece("|",62) = zcol.LQCD
				set ZDATA.piece("|",63) = zcol.LRTRVDT.toString("YEAR-MM-DD")
				set ZDATA.piece("|",64) = zcol.MCODE1
				set ZDATA.piece("|",65) = zcol.MCODE2
				set ZDATA.piece("|",66) = zcol.NONCRM
				set ZDATA.piece("|",67) = zcol.OPRIMKEY
				set ZDATA.piece("|",68) = zcol.OWNLNDVOL1
				set ZDATA.piece("|",69) = zcol.OWNLNDVOL2
				set ZDATA.piece("|",70) = zcol.OWNLNDVOL3
				set ZDATA.piece("|",71) = zcol.OWNLNDVOL4
				set ZDATA.piece("|",72) = zcol.OWNPORTN
				set ZDATA.piece("|",73) = zcol.PACN
				set ZDATA.piece("|",74) = zcol.PAGENO
				set ZDATA.piece("|",75) = zcol.PARTLFLG
				set ZDATA.piece("|",76) = zcol.PAYPARTY
				set ZDATA.piece("|",77) = zcol.PCHPRICE
				set ZDATA.piece("|",78) = zcol.PCOLVAL
				set ZDATA.piece("|",79) = zcol.PERSONID
				set ZDATA.piece("|",80) = zcol.PROVINCE
				set ZDATA.piece("|",81) = zcol.RAVANG
				set ZDATA.piece("|",82) = zcol.REASON
				set ZDATA.piece("|",83) = zcol.REMARKS
				set ZDATA.piece("|",84) = zcol.RESPUNIT
				set ZDATA.piece("|",85) = zcol.RIGHBAL
				set ZDATA.piece("|",86) = zcol.RIGHVAL
				set ZDATA.piece("|",87) = zcol.RMAREA
				set ZDATA.piece("|",88) = zcol.RMKPORTN
				set ZDATA.piece("|",89) = zcol.RMNUMBER
				set ZDATA.piece("|",90) = zcol.ROAD
				set ZDATA.piece("|",91) = zcol.RSCD
				set ZDATA.piece("|",92) = zcol.RULCOST
				set ZDATA.piece("|",93) = zcol.SEQNO
				set ZDATA.piece("|",94) = zcol.SHRHLDRG
				set ZDATA.piece("|",95) = zcol.SHRTNAME
				set ZDATA.piece("|",96) = zcol.STCKNO
				set ZDATA.piece("|",97) = zcol.STOREY
				set ZDATA.piece("|",98) = zcol.SUBBOT
				set ZDATA.piece("|",99) = zcol.SYMBOL
				set ZDATA.piece("|",100) = zcol.TAMBOL
				set ZDATA.piece("|",101) = zcol.TOTPORTN
				set ZDATA.piece("|",102) = zcol.UNITCD
				set ZDATA.piece("|",103) = zcol.USEDSTDT.toString("YEAR-MM-DD")
				set ZDATA.piece("|",104) = zcol.USEFULIF
				set ZDATA.piece("|",105) = zcol.ZATEEXP.toString("YEAR-MM-DD")
				set ZDATA.piece("|",106) = zcol.ZATEISSUEDT.toString("YEAR-MM-DD")
				set ZDATA.piece("|",107) = zcol.ZATEISSUER
				set ZDATA.piece("|",108) = zcol.ZATENUM
				set ZDATA.piece("|",109) = zcol.ZCERTBAL
				set ZDATA.piece("|",110) = zcol.ZCERTCID
				set ZDATA.piece("|",111) = zcol.ZCERTGRP
				set ZDATA.piece("|",112) = zcol.ZCERTID
				set ZDATA.piece("|",113) = zcol.ZCERTLOTH
				set ZDATA.piece("|",114) = zcol.ZCERTLOTL
				set ZDATA.piece("|",115) = zcol.ZCERTPERIOD
				set ZDATA.piece("|",116) = zcol.ZCERTUNIT
				set ZDATA.piece("|",117) = zcol.ZLGISSUEDT.toString("YEAR-MM-DD")
				set ZDATA.piece("|",118) = zcol.ZLGNUM
				set ZDATA.piece("|",119) = zcol.ZRADUR
				set ZDATA.piece("|",120) = zcol.ZRAEXP.toString("YEAR-MM-DD")
				set ZDATA.piece("|",121) = zcol.ZRAISSUER
				set ZDATA.piece("|",122) = zcol.ZRANUM
				set ZDATA.piece("|",123) = zcol.ZRATYPE
				
				
				if ZDATA[ZENTER  set ZDATA=$TR(ZDATA,ZENTER," ")
				if ZDATA[ZTAB    set ZDATA=$TR(ZDATA,ZTAB," ")
				if ZDATA[ZPROBLEM set ZDATA=$TR(ZDATA,ZPROBLEM," ")
				if ZDATA[$C(34) set ZDATA=$TR(ZDATA,$C(34)," ")
				set extcol.DATA = ZDATA
				do extcol.bypassSave()
				
					
			}
			
			new ZDETAIL
			set ZBOO		= zcol.BOO
			set ZCOLTYP		= zcol.COLTYP
			set ZCOLSUBT		= zcol.COLSUBT
			set APPRAISEDBY 	= zcol.APPBY
			set APPRAISEDDT 	= zcol.APPDT.toString("YEAR-MM-DD")
			set APPRAISALVAL 	= zcol.APPVAL
			set ZDETAIL		= ""
			
			set (ZBRNAME,ZCOLTYPDES,ZSUBBOTDES,ZCOLSUBDESC)="N/A"
			
		
			if Db.isDefined("UTBLBRCD","BRCD=:ZBOO") do {
				type RecordUTBLBRCD zbr = Db.getRecord("UTBLBRCD","BRCD=:ZBOO")
				set ZBRNAME = zbr.desc
			}
			if Db.isDefined("ZUTBLCOLTYP","COLCD=:ZCOLTYP") do {
				type RecordZUTBLCOLTYP coldesc = Db.getRecord("ZUTBLCOLTYP","COLCD=:ZCOLTYP")  
				set ZCOLTYPDESC=coldesc.desc
			}
			if Db.isDefined("ZUTBLCOLSUBT","COLCD=:ZCOLTYP,COLSUBT=:ZCOLSUBT") do {
				type RecordZUTBLCOLSUBT colsubdesc = Db.getRecord("ZUTBLCOLSUBT","COLCD=:ZCOLTYP,COLSUBT=:ZCOLSUBT")
				set ZCOLSUBDESC = colsubdesc.desc
			}
			if ZCOLTYP=1 do {
				
				set ZDETAIL.piece("|",1) = zcol.LRTRVDT  
				set ZDETAIL.piece("|",2) = zcol.GRPNO 
				set ZDETAIL.piece("|",3) = zcol.AMPHUR 
				set ZDETAIL.piece("|",4) = zcol.BKNUMBER 
				set ZDETAIL.piece("|",5) = zcol.PARTLFLG  
				set ZDETAIL.piece("|",6) = zcol.LNDNO
				set ZDETAIL.piece("|",7) = zcol.LNDVOL1
				set ZDETAIL.piece("|",8) = zcol.LNDVOL2 
				set ZDETAIL.piece("|",9) = zcol.LNDVOL3
				set ZDETAIL.piece("|",10) = zcol.LNDVOL4   
				set ZDETAIL.piece("|",11) = zcol.LOC1
				set ZDETAIL.piece("|",12) = zcol.LOC2       
				set ZDETAIL.piece("|",13) = zcol.LOC3
				set ZDETAIL.piece("|",14) = zcol.OWNPORTN   
				set ZDETAIL.piece("|",15) = zcol.OWNLNDVOL1 
				set ZDETAIL.piece("|",16) = zcol.OWNLNDVOL2 
				set ZDETAIL.piece("|",17) = zcol.OWNLNDVOL3 
				set ZDETAIL.piece("|",18) = zcol.OWNLNDVOL4 
				set ZDETAIL.piece("|",19) = zcol.PAGENO  
				set ZDETAIL.piece("|",20) = zcol.CONDPAR  
				set ZDETAIL.piece("|",21) = zcol.RMKPORTN   
				set ZDETAIL.piece("|",22) = zcol.PROVINCE
				set ZDETAIL.piece("|",23) = zcol.RAVANG
				set ZDETAIL.piece("|",24) = zcol.SEQNO   
				set ZDETAIL.piece("|",25) = zcol.TAMBOL 
				set ZDETAIL.piece("|",26) = zcol.TOTPORTN
				set ZDETAIL.piece("|",27) = zcol.LNDINFO
				set ZDETAIL.piece("|",28) = zcol.PROVINCE
				set ZDETAIL.piece("|",29) = zcol.ROAD
				set ZDETAIL.piece("|",30) = zcol.BSOI
				set ZDETAIL.piece("|",31) = zcol.TAMBOL  
				set ZDETAIL.piece("|",32) = zcol.BLDCODE 
				set ZDETAIL.piece("|",33) = zcol.BLDNAME  
				set ZDETAIL.piece("|",34) = zcol.BLDNUM 
				set ZDETAIL.piece("|",35) = zcol.BUILDNO  
				set ZDETAIL.piece("|",36) = zcol.RMNUMBER
				set ZDETAIL.piece("|",37) = zcol.STOREY
				set ZDETAIL.piece("|",38) = zcol.RMAREA
				
				set ^TMP("ZRPT4",1,zcol.coll) = ZBOO_"|"_ZBRNAME_"|"_ZCOLTYP_"|"_ZCOLTYPDES_"|"_ZCOLSUBT_"|"_ZCOLSUBDESC_"|"_zcol.coll_"|"_ZDETAIL
			}
		
			if (ZCOLTYP=2)!(ZCOLTYP=8) do {
				
				set ZDETAIL.piece("|",1) = zcol.LNDINFO
				set ZDETAIL.piece("|",2) = zcol.PROVINCE
				set ZDETAIL.piece("|",3) = zcol.ROAD
				set ZDETAIL.piece("|",4) = zcol.BSOI
				set ZDETAIL.piece("|",5) = zcol.TAMBOL 
				set ZDETAIL.piece("|",6) = zcol.BLDCODE
				set ZDETAIL.piece("|",7) = zcol.BLDNAME
				set ZDETAIL.piece("|",8) = zcol.BLDNUM 
				set ZDETAIL.piece("|",9) = zcol.BUILDNO
				set ZDETAIL.piece("|",10) = zcol.RMNUMBER 
				set ZDETAIL.piece("|",11) = zcol.STOREY 
				set ZDETAIL.piece("|",12) = zcol.RMAREA 
				
				set ^TMP("ZRPT4",2,zcol.coll) = ZBOO_"|"_ZBRNAME_"|"_ZCOLTYP_"|"_ZCOLTYPDES_"|"_ZCOLSUBT_"|"_ZCOLSUBDESC_"|"_zcol.coll_"|"_ZDETAIL
			}
			
			if (ZCOLTYP=3)!(ZCOLTYP=10) do {
				
				set ZDETAIL.piece("|",1) = zcol.AMPHUR
				set ZDETAIL.piece("|",2) = zcol.ENGCAP
				set ZDETAIL.piece("|",3) = zcol.MCODE1
				set ZDETAIL.piece("|",4) = zcol.MCODE2
				set ZDETAIL.piece("|",5) = zcol.UNITCD
				set ZDETAIL.piece("|",6) = zcol.USEDSTDT
				set ZDETAIL.piece("|",7) = zcol.PROVINCE.toString("DD/MM/YEAR")
				set ZDETAIL.piece("|",8) = zcol.ROAD 
				set ZDETAIL.piece("|",9) = zcol.BSOI
				set ZDETAIL.piece("|",10) = zcol.TAMBOL 
				
				set ^TMP("ZRPT4",3,zcol.coll) = ZBOO_"|"_ZBRNAME_"|"_ZCOLTYP_"|"_ZCOLTYPDES_"|"_ZCOLSUBT_"|"_ZCOLSUBDESC_"|"_zcol.coll_"|"_ZDETAIL
			}
			if ZCOLTYP=4 do {
				
				set ZDETAIL.piece("|",1)=zcol.CID 
				set ^TMP("ZRPT4",4,zcol.coll) = ZBOO_"|"_ZBRNAME_"|"_ZCOLTYP_"|"_ZCOLTYPDES_"|"_ZCOLSUBT_"|"_ZCOLSUBDESC_"|"_zcol.coll_"|"_ZDETAIL
			}
			if (ZCOLTYP=5)!(ZCOLTYP=6) do {
		
				set ZDETAIL.piece("|",1) = zcol.BLASTID
				set ZDETAIL.piece("|",2) = zcol.BSTRTID
				set ZDETAIL.piece("|",3) = zcol.SHRHLDRG
				
				set ^TMP("ZRPT4",6,zcol.coll) = ZBOO_"|"_ZBRNAME_"|"_ZCOLTYP_"|"_ZCOLTYPDES_"|"_ZCOLSUBT_"|"_ZCOLSUBDESC_"|"_zcol.coll_"|"_ZDETAIL
			}
			
			if ZCOLTYP=7 do {
		
				set ZDETAIL.piece("|",1) = zcol.GTEL
				set ZDETAIL.piece("|",2) = zcol.CACN
				set ZDETAIL.piece("|",3) = zcol.PACN
				
				set ^TMP("ZRPT4",7,zcol.coll) = ZBOO_"|"_ZBRNAME_"|"_ZCOLTYP_"|"_ZCOLTYPDES_"|"_ZCOLSUBT_"|"_ZCOLSUBDESC_"|"_zcol.coll_"|"_ZDETAIL
			}
			
			if (ZCOLTYP=11)!(ZCOLTYP=12)!(ZCOLTYP=9)!(ZCOLTYP=13) do {
				
				set ZDETAIL.piece("|",1) = zcol.AMPHUR	
				set ZDETAIL.piece("|",2) = zcol.PROVINCE
				set ZDETAIL.piece("|",3) = zcol.ROAD
				set ZDETAIL.piece("|",4) = zcol.BSOI
				set ZDETAIL.piece("|",5) = zcol.TAMBOL 
				set ZDETAIL.piece("|",6) = zcol.RIGHBAL
				set ZDETAIL.piece("|",7) = zcol.ZLGNUM
				set ZDETAIL.piece("|",8) = zcol.ZATEISSUER 
				set ZDETAIL.piece("|",9) = zcol.ZLGISSUEDT
				set ZDETAIL.piece("|",10) = zcol.ZATEEXP 
				set ZDETAIL.piece("|",11) = zcol.ZATEISSUEDT 
				set ZDETAIL.piece("|",12) = zcol.ZATENUM
				set ZDETAIL.piece("|",13) = zcol.ZRAEXP
				set ZDETAIL.piece("|",14) = zcol.ZRAISSUER
				set ZDETAIL.piece("|",15) = zcol.ZRANUM
				set ZDETAIL.piece("|",16) = zcol.ZRATYPE
				set ZDETAIL.piece("|",17) = zcol.ASDATE
				set ZDETAIL.piece("|",18) = zcol.CCRDT
				set ZDETAIL.piece("|",19) = zcol.CCRNUM
				set ZDETAIL.piece("|",20) = zcol.PAYPARTY
				set ZDETAIL.piece("|",21) = zcol.RIGHVAL
				set ZDETAIL.piece("|",22) = zcol.BOOTFR
				set ZDETAIL.piece("|",23) = zcol.DATETRF
				
				set ^TMP("ZRPT4",8,zcol.coll) = ZBOO_"|"_ZBRNAME_"|"_ZCOLTYP_"|"_ZCOLTYPDES_"|"_ZCOLSUBT_"|"_ZCOLSUBDESC_"|"_zcol.coll_"|"_ZDETAIL
			}
			if ZCOLTYP=14 do {
		
				set ZDETAIL.piece("|",1) = zcol.CID
				set ZDETAIL.piece("|",2) = zcol.ZCERTID
				set ZDETAIL.piece("|",3) = zcol.ZCERTCID
				set ZDETAIL.piece("|",4) = zcol.ZCERTBAL
				set ZDETAIL.piece("|",5) = zcol.ZCERTGRP
				set ZDETAIL.piece("|",6) = zcol.ZCERTLOTH
				set ZDETAIL.piece("|",7) = zcol.ZCERTLOTL
				set ZDETAIL.piece("|",8) = zcol.ZCERTPERIOD
				set ZDETAIL.piece("|",9) = zcol.ZCERTUNIT
				
				set ^TMP("ZRPT4",9,zcol.coll) = ZBOO_"|"_ZBRNAME_"|"_ZCOLTYP_"|"_ZCOLTYPDES_"|"_ZCOLSUBT_"|"_ZCOLSUBDESC_"|"_zcol.coll_"|"_ZDETAIL
	
			}
		}
	}
	
		
	
	quit
		
	
---------- THREXIT ------ Section marker
