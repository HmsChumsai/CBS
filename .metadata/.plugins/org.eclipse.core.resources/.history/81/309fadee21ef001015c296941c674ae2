//DO NOT MODIFY  CBS Messages Interface For GSB-Collatera|ZCBSCMS|||||||1

CIFINQ(String input)
	/* Created By Ravipong Chumsai Na Ayuthaya 04/10/11 */
							
	type public Number ER = 0
	type public String RM = ""
	type String custName, custNum, custSurname, custType, header, inqType, output, searchCond, typeValue
	type String respCode = "0000", respDesc = ""
	type Number ACN = "", CNT = 0, recordCount = 0,recordCifCount=0
	type String WHERE=""
	
	//set header 		= input.piece("|",1,2)	
	set SearchFlg 		= input.piece("|",11)	
	set SearchVal1 		= input.piece("|",12)	
	set SearchVal2		= input.piece("|",13)	
	set LastSearchVal 	= input.piece("|",14)	
	
	set output =""
	
	/* Search for the customer based on customer citizenship card ID, passport number, or
	   customer number.
	   
	   Get the customer number from the database and use that for the main select statement below */
	
	
	// Base search on citizenship ID number
	if SearchFlg = "N" do {
		
		// Search by customer Name
		if 'SearchVal1.isNull() do {
			set WHERE = "NAM LIKE '%"_SearchVal1_"%'"
			if 'SearchVal2.isNull() set WHERE = WHERE_" AND LNM LIKE '%"_SearchVal2_"%'"
		}
		if SearchVal1.isNull(),'SearchVal2.isNull() set WHERE = "LNM LIKE '%"_SearchVal2_"%'"
			
		
		else set ER = 1, RM = "Customer Name/Surname required " quit
		
		}
	if SearchFlg = "I" do {
		
		// Search by Identification Number
		if 'SearchVal1.isNull() do {
			type ResultSet rs = Db.select("ACN","CIF","ZCIZID=:SearchVal1")
			if 'rs.next() set ER = 1, RM = "Customer Citizenship ID Not Found: "_ SearchVal1 quit
			set ACN = rs.getCol("ACN")
			set WHERE = "ACN="_ACN
			
		}
		else set ER = 1, RM = "Customer ID Number required " quit
		
	}
	
	if SearchFlg = "P" do {
		
		// Search by Passport Number
		if 'SearchVal1.isNull() do {
			type ResultSet rs = Db.select("ACN","CIF","PASNUM=:SearchVal1")
			if 'rs.next() set ER = 1, RM = "Passport Number Not Found: "_SearchVal1 quit
			set ACN = rs.getCol("ACN")
			set WHERE = "ACN="_ACN
		}
		else set ER = 1, RM = "Passpord ID required " quit
	}	
	if SearchFlg = "T" do {
		
		// Search by Tax ID
		if 'SearchVal1.isNull() do {
			type ResultSet rs = Db.select("ACN","CIF","TAXID=:SearchVal1")
			if 'rs.next() set ER = 1, RM = "Tax ID Not Found: "_SearchVal1 quit
			set ACN = rs.getCol("ACN")
			set WHERE = "ACN="_ACN
		}
		else set ER = 1, RM = "Customer Name required " quit
		
		
	}
	
	do {
	
		type String exe()
		
		#ACCEPT Date=04/18/2011; Pgm=Pete Chenard; CR=unknown; Group=Dynamic
		type ResultSet recCount = Db.select("COUNT(ACN)","CIF",WHERE)
		if recCount.next() set recordCount = recCount.getCol(1)
	
	}
	

		set exit=0
		set ztmp=""
		type DbSet ds = Db.selectDbSet("CIF",WHERE)
		set more="N"
		set zwait=0
		set sendFLG=0
		set zstart=1
		if 'LastSearchVal.isNull() set zstart=0
		set i=0
		while ds.next() do { set more="Y" quit:exit
		
		type RecordCIF cif = ds.getRecord()
		
				if (LastSearchVal=cif.acn) set zstart=1
				if (zstart=1) do {								
				set output.piece("|",1) = cif.acn
				set output.piece("|",2) = cif.ztitle			
				set output.piece("|",3) = cif.fname		
				set output.piece("|",4) = cif.lnm			
				set output.piece("|",5) = cif.mname			
				set output.piece("|",7) = cif.ZCIZID			
				set output.piece("|",9) = cif.taxid
				if cif.pers=0 do {
				set output.piece("|",8) = ""
				set output.piece("|",10) = cif.mad1_cif.mad2_cif.mad3_cif.mad4_cif.mcity_cif.mstate_cif.mzip
				
				}
				if cif.pers=1 do {
				set output.piece("|",8) = "T"
				set output.piece("|",10) = cif.zoad1_cif.zoad1_cif.zoad1_cif.zoad1_cif.zocity_cif.zostate_cif.zozip
				
				}				
				
				if (i=10) set exit=1, zstart = 0 quit 
					
				set header.piece("|",3) = cif.acn
				set ztmp=ztmp_output
				set i=i+1			
				
			}
		}	
	set header.piece("|",1) = 0
	set header.piece("|",2)	= ""	
	set header.piece("|",4) = recordCount
	set header.piece("|",5) = more
	set output=""
	set output=header_"|"_ztmp			
		
	quit output
	
DEPINQ(String input)
	type public Number ER = 0
	type public String RM = ""
	type String custName, custNum, custSurname, custType, header, inqType, output, searchCond, typeValue
	type String respCode = "0000", respDesc = ""
	type Number ACN = "", CNT = 0, recordCount = 0,recordCifCount=0
	type String WHERE=""
	
	//set header 		= input.piece("|",1,2)	
	set FunctionFlag 	= input.piece("|",11)	
	set CifId 		= input.piece("|",12)	
	set AcctId		= input.piece("|",13)	
	set LastAcctId 		= input.piece("|",14)	
	
	set output =""
	
	/* Search for the customer based on customer citizenship card ID, passport number, or
	   customer number.
	   
	   Get the customer number from the database and use that for the main select statement below */
	
	
	// Base search on citizenship ID number
	if FunctionFlag = "C" do {
		
		// Search by customer Name
		if CifId.isNull() set ER = 1, RM = "CIF Number required " quit
		if 'Db.isDefined("CIF","ACN=:CifId") set ER = 1, RM = "CIF ID Not Found"
		set WHERE = "ACN="_CifId
			
		}
		
	if FunctionFlag = "A" do {
		
		// Search by customer Name
		if AcctId.isNull() set ER = 1, RM = "Account Number required " quit
		if 'Db.isDefined("DEP","CID=:AcctId") set ER = 1, RM = "Account Not Found"
		set WHERE = "CID="_AcctId
			
		}
	
	
		
	
	
	do {
	
		type String exe()
		
		#ACCEPT Date=04/18/2011; Pgm=Pete Chenard; CR=unknown; Group=Dynamic
		type ResultSet recCount = Db.select("COUNT(CID)","DEP",WHERE)
		if recCount.next() set recordCount = recCount.getCol(1)
	
	}
	

		set exit=0
		set ztmp=""
		type DbSet ds = Db.selectDbSet("DEP",WHERE)
		set more="0"
		set zwait=0
		set sendFLG=0
		set zstart=1
		
		if 'LastAcctId.isNull() set zstart=0
		set i=0
		while ds.next() do { quit:exit
		
		type RecordDEP dep = ds.getRecord()
		
				if (LastAcctId=dep.cid) set zstart=1
				if (zstart=1) do {								
				set output.piece("|",1) = dep.cid
				set output.piece("|",2) = dep.type			
				set output.piece("|",3) = dep.grp		
				set output.piece("|",4) = dep.zstatcd			
				set output.piece("|",5) = dep.boo			
				set output.piece("|",7) = dep.odlim			
				set output.piece("|",8) = dep.balavl
				set output.piece("|",9) = dep.bal
				set output.piece("|",10) = "0"
				set output.piece("|",11) = "0"
				set output.piece("|",12) = dep.tld.toString("YEAR/MM/DD")
				set output.piece("|",13) = "0"
				set output.piece("|",14) = dep.crcd
				set output.piece("|",15) = dep.acnrelc
				set output.piece("|",16) = dep.title1
				set output.piece("|",17) = dep.hldamt
				set output.piece("|",18) = dep.chkhld
				//set output.piece("|",8) = ...
				set output.piece("|",20) = dep.negacr+dep.negacrun
				set output.piece("|",21) = dep.negacr
				set output.piece("|",22) = dep.negacrun
				set output.piece("|",23) = dep.zrstr
				set output.piece("|",24) = dep.PBI
				set output.piece("|",25) = dep.rflg
				set output.piece("|",26) = dep.cc
				set output.piece("|",27) = dep.odt.toString("YEAR/MM/DD")
				set output.piece("|",28) = dep.acn
				
				}
				if (i=20) set exit=1, zstart = 0, more="1" quit 
					
				set footer.piece("|",1) = dep.cid
				set footer.piece("|",2) = recordCount
				
				set ztmp=ztmp_output
				set i=i+1			
				
			}
	
	set footer.piece("|",3)=more		
	set header.piece("|",1) = 0
	set header.piece("|",2)	= ""
	set output=""
	set output=header_"|"_ztmp_"|"_footer			
	
	quit output

CIFDET(String input)
	type public Number ER = 0
	type public String RM = ""
	type String respCode = "0000", respDesc = ""
	type Number ACN = "",recordCount = 0
	type String WHERE=""
	
	//set header 		= input.piece("|",1,2)	
	set CIFNo 	= input.piece("|",11)	
		
	
	set output =""
	if 'CIFNo.isNull() do {
		
		// Search by customer Name
		
		if 'Db.isDefined("CIF","ACN=:CIFNo") set ER = 1, RM = "CIF ID Not Found"
		set WHERE = "ACN="_CIFNo
			
		}
		set ztmp=""
		type DbSet ds = Db.selectDbSet("CIF",WHERE)
		while ds.next() do {
		
		type RecordCIF cif = ds.getRecord()
		
				type String mar=cif.mar, sex=cif.sex, educ=cif.educ, zrescd=cif.zrescd, own=cif.own, zocc=cif.zocc, zsocc=cif.zsocc, zposcd=cif.zposcd, emplno=cif.emplno, zoffcd=cif.zoffcd, mf=cif.mf, zresunit=cif.zresunit
				type String zisicsd=cif.zisicsd, zisicgc=cif.zisicgc,  zisicts=cif.zisicts, inc=cif.inc, nation=cif.nation, zrrt=cif.zrrt, zkycstat=cif.zkycstat, dlstate=cif.dlstate, ccode=cif.ccode
				type String pcntry=cif.pcntry, pstate=cif.pstate, pdist=cif.pcity, psubdist=cif.zpsdiscd, priv=cif.priv, cd1=cif.ZMINISTRYCD1, cd2=cif.ZMINISTRYCD2, cd3=cif.ZMINISTRYCD3
				type String mcntry=cif.mcntry, mstate=cif.mstate, mdist=cif.mcity, msubdist=cif.zmsdiscd, cc=cif.cc, relicd=cif.ZRELIGIONCD
				type String zocntry=cif.zocntry, zostate=cif.zostate, zodist=cif.zocity, zosubdist=cif.zosdiscd, dobcd=cif.zdobcd
	
				set output.piece("|",1) = cif.acn
				set output.piece("|",2) = cif.pers
				set output.piece("|",3) = cif.ztitle
				set output.piece("|",4) = cif.fname
				set output.piece("|",5) = cif.lnm
				set output.piece("|",6) = cif.mname
				set output.piece("|",7) = cif.zetitle
				set output.piece("|",8) = cif.zefname
				set output.piece("|",9) = cif.zelnm
				set output.piece("|",10) = cif.zemname
				set output.piece("|",11) = cif.pad1
				set output.piece("|",12) = cif.pad2
				set output.piece("|",13) = cif.pad3
				
				set output.piece("|",14) = Db.getOneRow("DESC","ZUTBLSDISTCD","pcntry,pstate,pdist,psubdist")
				set output.piece("|",15) = Db.getOneRow("DES","ZUTBLDIST","pcntry,pstate,pdist")
				set output.piece("|",16) = Db.getOneRow("DESC","STBLCNTRY1","pcntry,pstate")
				set output.piece("|",17) = cif.pzip
				set output.piece("|",18) = Db.getOneRow("DESC","STBLCNTRY","pcntry")
				set output.piece("|",19) = cif.mad1
				set output.piece("|",20) = cif.mad2
				set output.piece("|",21) = cif.mad3
				
				set output.piece("|",22) = Db.getOneRow("DESC","ZUTBLSDISTCD","mcntry,mstate,mdist,msubdist")
				set output.piece("|",23) = Db.getOneRow("DES","ZUTBLDIST","mcntry,mstate,mdist")
				set output.piece("|",24) = Db.getOneRow("DESC","STBLCNTRY1","mcntry,mstate")
				set output.piece("|",25) = cif.mzip
				set output.piece("|",26) = Db.getOneRow("DESC","STBLCNTRY","mcntry")
				set output.piece("|",27) = cif.zoad1
				set output.piece("|",28) = cif.zoad2
				set output.piece("|",29) = cif.zoad3
				
				set output.piece("|",30) = Db.getOneRow("DESC","ZUTBLSDISTCD","zocntry,zostate,zodist,zosubdist")
				set output.piece("|",31) = Db.getOneRow("DES","ZUTBLDIST","zocntry,zostate,zodist")
				set output.piece("|",32) = Db.getOneRow("DESC","STBLCNTRY1","zocntry,zostate")
				set output.piece("|",33) = cif.zozip
				set output.piece("|",34) = Db.getOneRow("DESC","STBLCNTRY","zocntry")
								
				set output.piece("|",35) = Db.getOneRow("DESC","UTBLMS","mar")
				set output.piece("|",36) = Db.getOneRow("DESC","UTBLSEX","sex")
				set output.piece("|",37) = cif.dob.toString("DD/MM/YEAR")
				set output.piece("|",38) = Db.getOneRow("TDES","ZUTBLNATION","nation")
				if 'educ.isNull(),Db.isDefined("UTBLEDUC","educ") set output.piece("|",39) = Db.getOneRow("DESC","UTBLEDUC","educ")
				if 'zrescd.isNull(),Db.isDefined("STBLCNTRY","zrescd") set output.piece("|",40) = Db.getOneRow("DESC","STBLCNTRY","zrescd")
				if 'own.isNull(),Db.isDefined("UTBLOWN","own") set output.piece("|",41) = Db.getOneRow("DESC","UTBLOWN","own")
				set output.piece("|",42) = cif.dep
				if 'zocc.isNull(),Db.isDefined("ZUTBLOC","zocc") set output.piece("|",43) = Db.getOneRow("TDES","ZUTBLOC","zocc")
				if 'zocc.isNull(),'zsocc.isNull(),Db.isDefined("ZUTBLSOC","zocc,zsocc") set output.piece("|",44) = Db.getOneRow("TDES","ZUTBLSOC","zocc,zsocc")
				if 'zposcd.isNull(),Db.isDefined("ZUTBLPOSITN","zposcd") set output.piece("|",45) = Db.getOneRow("DESC","ZUTBLPOSITN","zposcd")
				if 'emplno.isNull(),Db.isDefined("UTBLEMPLOYER","emplno") set output.piece("|",46) = Db.getOneRow("FMDESC","UTBLEMPLOYER","emplno")
				if 'zisicsd.isNull(),Db.isDefined("ZUTBLISICSD","zisicsd") set output.piece("|",47) = Db.getOneRow("TDES","ZUTBLISICSD","zisicsd")
				if 'zisicsd.isNull(),'zisicgc.isNull(),Db.isDefined("ZUTBLISICGC","zisicsd,zisicgc") set output.piece("|",48) = Db.getOneRow("TDES","ZUTBLISICGC","zisicsd,zisicgc")
				if 'zisicsd.isNull(),'zisicgc.isNull(),'zisicts.isNull(),Db.isDefined("ZUTBLISICTS","zisicsd,zisicgc,zisicts") set output.piece("|",49) = Db.getOneRow("TDES","ZUTBLISICTS","zisicsd,zisicgc,zisicts")
				if 'inc.isNull(),Db.isDefined("UTBLIC","inc") set output.piece("|",50) = Db.getOneRow("DESC","UTBLIC","inc")
				set output.piece("|",51) = cif.hph
				set output.piece("|",52) = cif.aph
				set output.piece("|",53) = cif.bph
				set output.piece("|",54) = cif.bphext
				set output.piece("|",55) = cif.faxnum
				set output.piece("|",56) = $S(cif.zvipflg=1:"Yes",cif.zvipflg=0:"No")
				set output.piece("|",57) = cif.extcif
				set output.piece("|",58) = cif.dod.toString("YEAR/MM/DD")
				set output.piece("|",59) = cif.email
				if 'zrrt.isNull(),Db.isDefined("ZUTBLRRT","zrrt") set output.piece("|",60) =  Db.getOneRow("DESC","ZUTBLRRT","zrrt")
				set output.piece("|",61) = cif.atn
				set output.piece("|",62) = cif.zcrrtdt.toString("YEAR/MM/DD")
				if 'zkycstat.isNull(),Db.isDefined("ZUTBLKYCSTAT","zkycstat") set output.piece("|",63) = Db.getOneRow("DESC1","ZUTBLKYCSTAT","zkycstat")
				set output.piece("|",64) = cif.zstfid
				set output.piece("|",65) = $S(cif.znfa<0:"-",1:"+")	//Net Fixed Asset (exclude Land) Sign "-" for minus, "+" for plus
				set output.piece("|",66) = cif.znfa
				set output.piece("|",67) = $S(cif.as<0:"-",1:"+")	//Annual Sales Sign "-" for minus, "+" for plus
				set output.piece("|",68) = cif.as
				set output.piece("|",69) = cif.ne
				
				set output.piece("|",70) = $S(cif.ta<0:"-",1:"+")	//Total Assets Sign "-" for minus, "+" for plus
				set output.piece("|",71) = cif.ta
				set output.piece("|",72) = cif.lfu.toString("YEAR/MM/DD")
				set output.piece("|",73) = $S(cif.nw<0:"-",1:"+") 	//NetWorthSign
				set output.piece("|",74) = cif.nw
				set output.piece("|",75) = $S(cif.cre<0:"-",1:"+")	//CreditLineSign
				set output.piece("|",76) = cif.cre
				set output.piece("|",77) = cif.fye.toString("MM/DD")
				set output.piece("|",78) = cif.govt
				set output.piece("|",79) = cif.con
				set output.piece("|",80) = cif.zextbnk
				set output.piece("|",81) = cif.boo
				set output.piece("|",82) = cif.co
				set output.piece("|",83) = cif.zktbccode
				set output.piece("|",84) = cif.zipc
				set output.piece("|",85) = cif.zcizid
				set output.piece("|",86) = cif.taxid
				set output.piece("|",87) = cif.dlnum
				if 'pcntry.isNull(),'dlstate.isNull(),Db.isDefined("STBLCNTRY1","pcntry,dlstate") set output.piece("|",88) = Db.getOneRow("DESC","STBLCNTRY1","pcntry,dlstate")
				set output.piece("|",89) = cif.dlexpdt.toString("YEAR/MM/DD")
				set output.piece("|",90) = cif.pasnum
				set output.piece("|",91) = cif.pci
				set output.piece("|",92) = cif.ped.toString("YEAR/MM/DD")
				set output.piece("|",93) = cif.zbotnum
				set output.piece("|",94) = cif.zgovnum
				set output.piece("|",95) = cif.zovrseaj
				set output.piece("|",96) = cif.zciflg
				set output.piece("|",97) = cif.zboiflg
				set output.piece("|",98) = cif.zjin
				set output.piece("|",99) = cif.zjrdate.toString("YEAR/MM/DD")
				set output.piece("|",100) = cif.zswiftcd
				set output.piece("|",101) = cif.zficd
				set output.piece("|",102) = cif.zfiasscd
				set output.piece("|",103) = cif.zintovgov
				set output.piece("|",104) = cif.zothjid
				set output.piece("|",105) = cif.oit
				set output.piece("|",106) = cif.issr
				set output.piece("|",107) = cif.oin
				set output.piece("|",108) = cif.oed.toString("YEAR/MM/DD")
				if 'ccode.isNull(),Db.isDefined("UTBLCC","ccode") set output.piece("|",109) = Db.getOneRow("DESC","UTBLCC","ccode")
				if 'zoffcd.isNull(),Db.isDefined("ZUTBLOFFICER","zoffcd") set output.piece("|",110) = Db.getOneRow("EMPNAME","ZUTBLOFFICER","zoffcd")
				if 'mf.isNull(),Db.isDefined("UTBLMF","mf") set output.piece("|",111) = Db.getOneRow("DESC","UTBLMF","mf")
				if 'zresunit.isNull(),Db.isDefined("UTBLCCNTR","zresunit") set output.piece("|",112) = Db.getOneRow("DESC","UTBLCCNTR","zresunit")
				if 'priv.isNull(),Db.isDefined("STBLCIFPRIV","priv") set output.piece("|",113) = Db.getOneRow("DES","STBLCIFPRIV","priv")
				set output.piece("|",114) = cif.sol
				set output.piece("|",115) = cif.martel
				set output.piece("|",116) = cif.marem
				set output.piece("|",117) =cif.mardm
				set output.piece("|",118) = cif.agent
				set output.piece("|",119) = cif.locale
				set output.piece("|",120) = cif.brreg
				set output.piece("|",121) = cif.shhld
				set output.piece("|",122) = $S(cif.cusamt<0:"-",1:"+")
				set output.piece("|",123) = cif.cusamt
				set output.piece("|",124) = cif.cusdate.toString("YEAR/MM/DD")
				set output.piece("|",125) = cif.plan
				set output.piece("|",126) = cif.crcd
				set output.piece("|",127) = cif.rflgc
				set output.piece("|",128) = cif.dao.toString("YEAR/MM/DD")
				set output.piece("|",129) = cif.fmld.toString("YEAR/MM/DD")
				set output.piece("|",130) = cif.convcif
				set output.piece("|",131) = cif.zrbnam
				set output.piece("|",132) = cif.zrbtnam
				set output.piece("|",133) = cif.zcikey
				set output.piece("|",134) = cif.zciupddat.toString("YEAR/MM/DD")
				set output.piece("|",135) = cif.zciby
				set output.piece("|",136) = cif.zcirip1
				set output.piece("|",137) = cif.zciipt1
				set output.piece("|",138) = cif.zcirit
				set output.piece("|",139) = cif.zdataset.toString("YEAR/MM/DD")
				set output.piece("|",140) = cif.zmoufl
				
					
				
			}
	
		
	set header.piece("|",1) = 0
	set header.piece("|",2)	= 0
	
	
	quit (header_"|"_output)
/*
LNINQ(String input)
	/*
	type public Number ER = 0
	type public String RM = ""
	
	type Number ACN = "", CNT = 0, recordCount = 0,recordCifCount=0
	type String WHERE=""
	
	//set header 		= input.piece("|",1,2)	
	set FunctionFlag 	= input.piece("|",3)	
	set CifId 		= input.piece("|",4)	
	set AcctId		= input.piece("|",5)	
	set LastAcctId 		= input.piece("|",6)	
	
	set output =""
	
	
	
	// Base search on citizenship ID number
	if FunctionFlag = "C" do {
		
		// Search by customer Name
		if CifId.isNull() set ER = 1, RM = "CIF Number required " quit
		if 'Db.isDefined("CIF","ACN=:CifId") set ER = 1, RM = "CIF ID Not Found"
		set WHERE = "ACN="_CifId
			
		}
		
	if FunctionFlag = "A" do {
		
		// Search by customer Name
		if AcctId.isNull() set ER = 1, RM = "Account Number required " quit
		if 'Db.isDefined("DEP","CID=:AcctId") set ER = 1, RM = "Account Not Found"
		set WHERE = "CID="_AcctId
			
		}
	
	
		
	
	
	do {
	
		type String exe()
		
		#ACCEPT Date=04/18/2011; Pgm=Pete Chenard; CR=unknown; Group=Dynamic
		type ResultSet recCount = Db.select("COUNT(CID)","ACN",WHERE)
		if recCount.next() set recordCount = recCount.getCol(1)
	
	}
	

		set exit=0
		set ztmp=""
		type DbSet ds = Db.selectDbSet("ACN",WHERE)
		set more="0"
		set zwait=0
		set sendFLG=0
		set zstart=1
		
		if 'LastAcctId.isNull() set zstart=0
		set i=0
		while ds.next() do { quit:exit
		if ds.getRecord().cls ="D" do {
		type RecordACN dep = ds.getRecord()
		/*
				if (LastAcctId=dep.cid) set zstart=1
				if (zstart=1) do {								
				set output.piece("|",1) = dep.cid
				set output.piece("|",2) = dep.type			
				set output.piece("|",3) = dep.grp		
				set output.piece("|",4) = dep.zstatcd			
				set output.piece("|",5) = dep.boo			
				set output.piece("|",7) = dep.odlim			
				set output.piece("|",8) = dep.balavl
				set output.piece("|",9) = dep.bal
				set output.piece("|",10) = "0"
				set output.piece("|",11) = "0"
				set output.piece("|",12) = dep.tld.toString("YEAR/MM/DD")
				set output.piece("|",13) = "0"
				set output.piece("|",14) = dep.crcd
				set output.piece("|",15) = dep.acnrelc
				set output.piece("|",16) = dep.title1
				set output.piece("|",17) = dep.hldamt
				set output.piece("|",18) = dep.chkhld
				//set output.piece("|",8) = ...
				set output.piece("|",20) = dep.negacr+dep.negacrun
				set output.piece("|",21) = dep.negacr
				set output.piece("|",22) = dep.negacrun
				set output.piece("|",23) = dep.zrstr
				set output.piece("|",24) = dep.PBI
				set output.piece("|",25) = dep.rflg
				set output.piece("|",26) = dep.cc
				set output.piece("|",27) = dep.odt.toString("YEAR/MM/DD")
				set output.piece("|",28) = dep.acn
				
				}
				if (i=20) set exit=1, zstart = 0, more="1" quit 
					
				//set footer.piece("|",1) = dep.cid
				set footer.piece("|",2) = recordCount
				
				set ztmp=ztmp_output
				set i=i+1			
			}
		if ds.getRecord().cls ="L" do {	
				
				
				}
			}
		
		
	set footer.piece("|",3)=more		
	set header.piece("|",1) = 0
	set header.piece("|",2)	= ""
	set output=""
	set output=header_"|"_ztmp_"|"_footer			
	
	quit output
	

