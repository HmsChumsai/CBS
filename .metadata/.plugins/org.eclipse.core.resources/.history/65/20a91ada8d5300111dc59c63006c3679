//DO NOT MODIFY  Utility for CIF Extract|ZEXTUTIL|||||||1


	/*
	ORIG: Ravipong Chumsai Na Ayuthaya - 15/12/2011
	DESC: CMS Conversion-Extraction Utility
	*/


	do SYSVAR^SCADRV0()

CIFEXT()
	
	new ZFID,tWRITE,ZDATA
	set ZPID = "ZEXTCMS"
	set ZTJD = %SystemDate
	set ZEXTDAT = $$DAT^%ZM(ZTJD,"YEARMMDD")
	type IO io=Class.new("IO")
	set io.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZCMSEXT_CIF_"_ZTJD_".TXT"
	set io.openParams="NEWV/WRITE"
	do io.open()
	//Setup Header
	
	set tWRITE = "ACN"_"|"_"THAI_TITLE"_"|"_"THAI_FNAME"_"|"_"THAI_LNAME"_"|"_"THAI_MNAME"_"|"_"CITIZEN_ID"_"|"_"TAX_ID"_"|"_"LEGAL_ADDR1"
	set tWRITE = tWRITE_"|"_"LEGAL_ADDR2"_"|"_"LEGAL_ADDR3"_"|"_"LEGAL_TAMBOL_CD"_"|"_"LEGAL_AMPHUR_CD"_"|"_"LEGAL_PROVINCE_CD"
	set tWRITE = tWRITE_"|"_"LEGAL_COUNTRY_CD"_"|"_"|"_"LEGAL_POSTAL_CD"_"|"_"HOME_PHONE"_"|"_"MOBILE_PHONE"_"|"_"OFFICE_PHONE"
	set tWRITE = tWRITE_"|"_"OFFICE_PHONE_EXT"_"|"_"JURISTIC_ID"_"|"_"MAILING_ADDR1"_"|"_"MAILING_ADDR2"_"|"_"MAILING_ADDR3"
	set tWRITE = tWRITE_"|"_"MAILING_TAMBOL_CD"_"|"_"MAILING_AMPHUR_CD"_"|"_"MAILING_PROVINCE_CD"_"|"_"MAILING_COUNTRY_CD"
	set tWRITE = tWRITE_"|"_"MAILING_POSTAL_CD"_"|"_"OFFICE_ADDR1"_"|"_"OFFICE_ADDR3"_"|"_"OFFICE_ADDR2"_"|"_"OFFICE_TAMBOL_CD"
	set tWRITE = tWRITE_"|"_"OFFICE_AMPHUR_CD"_"|"_"OFFICE_PROVINCE_CD"_"|"_"OFFICE_COUNTRY_CD"_"|"_"OFFICE_POSTAL_CD"
	set tWRITE = tWRITE_"|"_"MARITAL_STATUS"_"|"_"SEX"_"|"_"DATE_OF_BIRTH"_"|"_"FAX_NUMBER"_"|"_"EMAIL"_"|"_"CUST_CD"_"|"_"CUST_TYPE"_"|"_"PASSPORT_NUMBER"
	
	do io.write(tWRITE.piece("|",1,22))
	do io.write(tWRITE.piece("|",23,44))
	
	set ZDATA=""
	
	
	type ResultSet rs = Db.select("DATA","TMPRPT1","PID=:ZPID")
	while rs.next() do { 
		
		set ZDATA = rs.getCol(1).piece("|",1,35)
		do io.write(ZDATA)
		
		}
	
	do io.close()
	
	quit
	
ACNEXT()	
	
	new ZFID,tWRITE,ZDATA
	set ZPID = "ZEXTCMS2"
	set ZTJD = %SystemDate
	set ZEXTDAT = $$DAT^%ZM(ZTJD,"YEARMMDD")
	set ZDATA=""
	type IO io=Class.new("IO")
	set io.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZCMSEXT_ACN_"_ZTJD_".TXT"
	set io.openParams="NEWV/WRITE"
	do io.open()
	
	set tWRITE = "CID"_"|"_"PRODUCT_CLASS"_"|"_"PRODUCT_GRP"_"|"_"PRODUCT_GRP_DESC"_"|"_"PRODUCT_TYPE"_"|"_"PRODUCT_TYPE_DESC"_"|"_"ACCT_NAME"
	set tWRITE = tWRITE_"|"_"PRIMARY_CIF"_"|"_"ACCT_STATUS"_"|"_"ACCT_STATUS_DESC"_"|"_"OUTS_BAL"_"|"_"AVAIL_BAL"
	set tWRITE = tWRITE_"|"_"MASTER_ACCT_NO"_"|"_"ACCT_SUBTYPE"_"|"_"MARKET_CD"_"|"_"MARKET_CD_DESC"_"|"_"LIMIT_AMT"_"|"_"DT_OPENED"
	set tWRITE = tWRITE_"|"_"DT_CLOSED"_"|"_"OWNER_BR"_"|"_"OWNER_BR_DESC"_"|"_"INT_RECEIVE"_"|"_"INT_SUSPENSE"
	set tWRITE = tWRITE_"|"_"LEGAL_ID"_"|"_"TOTAL_DUE"_"|"_"MISC_CHARGE"_"|"_"LATE_CHARGE_AMT"
	set tWRITE = tWRITE_"|"_"INT_PASS_DUE"_"|"_"PRIN_PASS_DUE"_"|"_"LOAN_CLASS"_"|"_"RESCIDENCE_CLASS"_"|"_"ACCT_SUBTYPE_DESC"_"|"_"DATE_OF_NOTE"_"|"_"OD_LIMIT TOTAL_LOAN_BAL"_"|"_"UNPAID_FEE"
	
	do io.write(tWRITE.extract(1,512))
	
	type ResultSet rs = Db.select("DATA","TMPRPT1","PID=:ZPID")
	
	while rs.next() do { 
		
		set ZDATA = rs.getCol(1)
		do io.write(ZDATA)
		}
	
	do io.close()
				
	quit
	
ZCOLEXT()
	
	
	kill ^TMP("ZRPT2")
	kill ^TMP("ZRPT4")
	new ZPID,tWRITE,ZDATA,ZDATA2,ZRSCOL,ZCNT,ztmp,zlength
	set ZPID = "ZCONVCOL"
	set ZTJD = %SystemDate
	set ZEXTDAT = $$DAT^%ZM(ZTJD,"YEARMMDD")
	set rpt2="rpt2"
	set ZPID4="ZRPT4"
	set ZPID2="ZRPT2"
	set ZPID4="ZRPT3"
	type IO io=Class.new("IO")
	set io.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZCMSEXT_COL_"_ZTJD_".TXT"
	set io.recordSize = 1024
	set io.openParams="NEWV/WRITE"
	do io.open()
	
	type IO io2=Class.new("IO")
	set io2.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZCMSEXT_ZCOLOWNLINK_"_ZTJD_".TXT"
	set io2.recordSize = 1024
	set io2.openParams="NEWV/WRITE"
	do io2.open()
	
	
	
	set tWRITE = "AMPHUR"_"|"_"AO"_"|"_"APDCODE"_"|"_"APPBOO"_"|"_"APPBY"_"|"_"APPDT"_"|"_"APPOFF1"_"|"_"APPOFF2"_"|"_"APPOFF3"_"|"_"APPTID"_"|"_"APPVAL"
	set tWRITE = tWRITE_"|"_"ASDATE"_"|"_"BKNUMBER"_"|"_"BLASTID"_"|"_"BLDCODE"_"|"_"BLDNAME"_"|"_"BLDNUM"_"|"_"BLDTYPE"_"|"_"BLDVAL"_"|"_"BOO"
	set tWRITE = tWRITE_"|"_"BOOTFR"_"|"_"BOTCODE"_"|"_"BOTRSKRT"_"|"_"BSOI"_"|"_"BSTRTID"_"|"_"BUILDNO"_"|"_"CACN"_"|"_"CC"_"|"_"CCRDT"_"|"_"CCRNUM"
	set tWRITE = tWRITE_"|"_"CERNO"_"|"_"CID"_"|"_"CMDCD"_"|"_"COLL"_"|"_"COLSUBT"_"|"_"COLTYP"_"|"_"CONDPAR"_"|"_"CONVDT"_"|"_"CRCD"_"|"_"DATETRF"
	set tWRITE = tWRITE_"|"_"DESC"_"|"_"DOB"_"|"_"DOCLCT"_"|"_"DOD"_"|"_"ENGCAP"_"|"_"EXTRSKR"_"|"_"FLOOR"_"|"_"GRPNO"_"|"_"GTEL"_"|"_"INSREQ"_"|"_"KTBRKR"_"|"_"LNDINFO"
	set tWRITE = tWRITE_"|"_"LNDNO"_"|"_"LNDVAL"_"|"_"LNDVOL1"_"|"_"LNDVOL2"_"|"_"LNDVOL3"_"|"_"LNDVOL4"_"|"_"LOC1"_"|"_"LOC2"_"|"_"LOC3"_"|"_"LQCD"_"|"_"LRTRVDT"
	set tWRITE = tWRITE_"|"_"MCODE1"_"|"_"MCODE2"_"|"_"NONCRM"_"|"_"OPRIMKEY"_"|"_"OWNLNDVOL1"_"|"_"OWNLNDVOL2"_"|"_"OWNLNDVOL3"_"|"_"OWNLNDVOL4"_"|"_"OWNPORTN"
	set tWRITE = tWRITE_"|"_"PACN"_"|"_"PAGENO"_"|"_"PARTLFLG"_"|"_"PAYPARTY"_"|"_"PCHPRICE"_"|"_"PCOLVAL"_"|"_"PERSONID"_"|"_"PROVINCE"_"|"_"RAVANG"
	set tWRITE = tWRITE_"|"_"REASON"_"|"_"REMARKS"_"|"_"RESPUNIT"_"|"_"RIGHBAL"_"|"_"RIGHVAL"_"|"_"RMAREA"_"|"_"RMKPORTN"_"|"_"RMNUMBER"_"|"_"ROAD"
	set tWRITE = tWRITE_"|"_"RSCD"_"|"_"RULCOST"_"|"_"SEQNO"_"|"_"SHRHLDRG"_"|"_"SHRTNAME"_"|"_"STCKNO"_"|"_"STOREY"_"|"_"SUBBOT"_"|"_"SYMBOL"_"|"_"TAMBOL"
	set tWRITE = tWRITE_"|"_"TOTPORTN"_"|"_"UNITCD"_"|"_"USEDSTDT"_"|"_"SEFULIF"_"|"_"ZATEEXP"_"|"_"ZATEISSUEDT"_"|"_"ZATEISSUER"_"|"_"ZATENUM"_"|"_"ZCERTBAL"
	set tWRITE = tWRITE_"|"_"ZCERTCID"_"|"_"ZCERTGRP"_"|"_"ZCERTID"_"|"_"ZCERTLOTH"_"|"_"ZCERTLOTL"_"|"_"ZCERTPERIOD"_"|"_"ZCERTUNIT"_"|"_"ZLGISSUEDT"_"|"_"ZLGNUM"_"|"_"ZRADUR"_"|"_"ZRAEXP"_"|"_"ZRAISSUER"_"|"_"ZRANUM"_"|"_"ZRATYPE|"
	
	
	
	do io.write(tWRITE)
	
	
	set tWRITE = "ACN"_"|"_"COLL"_"|"_"PAROWNFLG|"
	
	do io2.write(tWRITE)
	set i = 0
	
	type ResultSet rs = Db.select("DATA,KEY1","TMPRPT1","PID=:ZPID")
	//first 1000
	while rs.next() do { 
		
		
		set (ZDATA,ZDATA2,ZRSCOL,ZBOTDES,ZCNT,ztmp)=""	
		set ZRSCOL	= rs.getCol(2)
		set ZDATA 	= rs.getCol(1)
		set ZBOO	= ZDATA.piece("|",20)
		set ZCOLTYP 	= ZDATA.piece("|",36)
		set ZCOLSUBT	= ZDATA.piece("|",35)
		set ZBOTCD	= ZDATA.piece("|",22)
		set ZSUBBOTCD	= ZDATA.piece("|",98)
		set ZAMT	= ZDATA.piece("|",11)
		set ZCOLLID	= ZDATA.piece("|",34)
		set ZCID	= ZDATA.piece("|",73)
		
		
		
		set ZBOTDES="N/A"
	
		
		type ResultSet botdesc = Db.select("DESC","ZUTBLSUBBOT","BOTCODE=:ZBOTCD AND SUBBOT=:ZSUBBOTCD")
		if 'botdesc.isEmpty(),botdesc.next() set ZBOTDES=botdesc.getCol(1)
		
		type ResultSet rscol = Db.select("ACN,COLL,PAROWNFLG","ZCOLOWNLINK","COLL=:ZRSCOL")
		while rscol.next() do {
			
			set ZDATA2 = rscol.getCol(1)_"|"_rscol.getCol(2)_"|"_rscol.getCol(3)
			do io2.write(ZDATA2)
			}
			if ZSUBBOTCD="" set ZSUBBOTCD="N/A"
			if ZBOTCD=""    set ZBOTCD="N/A"
			if ZBOO="" 	set ZBOO="N/A"
			if ZCOLTYP=""	set ZCOLTYP="N/A"
			if ZCOLSUBT=""	set ZCOLSUBT="N/A"
			
			
			
			type RecordTMPRPT6 rpt2 = Db.getRecord("TMPRPT6","PID='ZRPT1',ZBOO,ZCOLTYP,ZCOLSUBT,ZBOTCD,ZSUBBOTCD,ZBOTDES",1)
			
			set ZTMP2DATA.piece("|",1) = rpt2.DATA.piece("|",1)+1
			set ZTMP2DATA.piece("|",2) = rpt2.DATA.piece("|",2)+ZAMT
			set rpt2.DATA		  = ZTMP2DATA
			
		
			do rpt2.save()
			
			
			
			type RecordTMPRPT5 rpt4 = Db.getRecord("TMPRPT5","PID='ZRPT4',ZBOO,ZCOLTYP,ZCOLSUBT,ZBOTCD,ZSUBBOTCD",1)
			set ZTMP4DATA.piece("|",1) = rpt4.DATA.piece("|",1)+1
			set ZTMP4DATA.piece("|",2) = rpt4.DATA.piece("|",2)+ZAMT
			set rpt4.DATA	=  ZTMP4DATA 
			do rpt4.save()
			
			
		do io.write(ZDATA)
		
			
		}
	
		
	do io.close()	
	do io2.close()
			
	quit

ZCTRCTEXT()
		
	kill ^TMP("ZRPT3")
	kill ^TMP("ztmp3")
	kill ^TMP("CNTEXT")
	kill ^TMP("CNTALL")	
	new ZPID,tWRITE,ZDATA1,ZDATA2,ZDATA3,ZDATA4,ZTMP,ZCID,ZACN
	set ZPID = "ZCONVCNT"
	set ZTJD = %SystemDate
	set ZEXTDAT = $$DAT^%ZM(ZTJD,"YEARMMDD")
	
	set rpt1="rpt1"
	
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZCMSEXT_ZCTRCT_"_ZTJD_".TXT"
	set io1.openParams="NEWV/WRITE"
	set io1.recordSize = 1024
	do io1.open()
	set tWRITE = "BOO"_"|"_"CC"_"|"_"CONTRREL"_"|"_"CONVDT"_"|"_"CRTDATE"_"|"_"CRTUSER"_"|"_"CTRCT"_"|"_"CTRCTDT"_"|"_"CTRSTAT"_"|"_"MCTRCT"
	set tWRITE = tWRITE_"|"_"PLDGAMT"_"|"_"PLDGSEQ"_"|"_"RELDATE"_"|"_"REMARKS"_"|"_"RESPUNIT"
	do io1.write(tWRITE)
	
	type IO io2=Class.new("IO")
	set io2.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZCMSEXT_ZCTRCTACN_"_ZTJD_".TXT"
	set io2.openParams="NEWV/WRITE"
	set io2.recordSize = 1024
	do io2.open()
	set tWRITE = "CID"_"|"_"CTRCT"
	do io2.write(tWRITE)
	
	type IO io3=Class.new("IO")
	set io3.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZCMSEXT_ZCTRCTCIF_"_ZTJD_".TXT"
	set io3.openParams="NEWV/WRITE"
	set io3.recordSize = 1024
	do io3.open()
	set tWRITE = "ACN"_"|"_"CTRCT"
	do io3.write(tWRITE)
	
	type IO io4=Class.new("IO")
	set io4.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZCMSEXT_ZCTRCTCOL_"_ZTJD_".TXT"
	set io4.openParams="NEWV/WRITE"
	set io4.recordSize = 1024
	do io4.open()
	set tWRITE = "CTRCT"_"|"_"COLL"_"|"_"CCSTAT"_"|"_"PLDGVAL"_"|"_"RELDATE"
	
	do io4.write(tWRITE)

	set ZPOINTER = $O(^TMP("ZCONVCNT",""))
	
	//type ResultSet rs = Db.select("DATA,KEY1","TMPRPT2","PID=:ZPID AND KEY2='0'")
	while 'ZPOINTER.isNull() do {
		
		set (ZDATA1,ZDATA2,ZDATA3,ZDATA4,ZCID,ZACN)=""
		set ZTMP = ^TMP("ZCONVCNT",ZPOINTER,0)
		set ZDATA1 = ^TMP("ZCONVCNT",ZPOINTER,0)
		set ZPOINTER = $O(^TMP("ZCONVCNT",ZPOINTER))

		set ZBOO 	= $P(ZTMP,"|",1)
         	set ZTYP 	= $P(ZTMP,"|",3)
         	set ZSTAT 	= $P(ZTMP,"|",9)
         	set ZAMT	= $P(ZTMP,"|",11)
		
		set ZCTRCT = ZTMP.piece("|",7)
		
		type ResultSet data2 = Db.select("CID","ZCTRCTACN","CTRCT=:ZCTRCT")
		while data2.next() do {
			
			set ZCID = data2.getCol(1)
			set ZDATA2=ZCID_"|"_ZCTRCT
			do io2.write(ZDATA2)
			
			type RecordACN acn = Db.getRecord("ACN","CID=:ZCID")       	
	         	set ZPRODTYP	= acn.type
	         	
	         	
	         	//tmp for count acct	         	
	         	type RecordTMPRPT4 tmp3 = Db.getRecord("TMPRPT4","PID='ztmp3',ZBOO,ZTYP,ZSTAT,ZPRODTYP",1)
	         	set tmp3.DATA=tmp3.DATA+1
		         	
		         	type ResultSet rscol = Db.select("COLL","ZCTRCTCOL","ZCTRCTCOL.CTRCT=:rs.getCol(2)")			
				while rscol.next() do {			
		         	set ZRSCOL = rscol.getCol(1)	
				type RecordZCOL zcol = Db.getRecord("ZCOL","COLL=:ZRSCOL")
		         	set ZCOLTYP	=	zcol.COLTYP
		         	set ZCOLSUBT	=	zcol.COLSUBT
		         	type RecordTMPRPT6 rpt3 = Db.getRecord("TMPRPT6","PID='ZRPT3',ZBOO,ZTYP,ZSTAT,ZPRODTYP,ZCOLTYP,ZCOLSUBT",1)								
				set ZTMP3DATA.piece("|",1) = tmp3.DATA
				set ZTMP3DATA.piece("|",2) = rpt3.DATA.piece("|",2)+1
				set rpt3.DATA=ZTMP3DATA
				do rpt3.save()
					}
	         	do tmp3.save()
	         	
			}
		
		type ResultSet data3 = Db.select("ACN","ZCTRCTCIF","CTRCT=:ZCTRCT")
		while data3.next() do {
			set ZACN = data3.getCol(1)
			set ZDATA3 = ZACN_"|"_ZCTRCT
			do io3.write(ZDATA3)
	 
			}
		
		type ResultSet data4 = Db.select("CTRCT,COLL,CCSTAT,PLDGVAL,RELDATE","ZCTRCTCOL","CTRCT=:ZCTRCT")
		while data4.next() do {			
			type Date ZRELDATE = data4.getCol(5)
			if 'data4.getCol(5).isNull(),data4.getCol(5)'=0 set ZRELDATE = ZRELDATE.toString("YEAR-MM-DD")_"-00.00.00"
			else set ZRELDATE=""
							
			set ZDATA4 = data4.getCol(1)_"|"_data4.getCol(2)_"|"_data4.getCol(3)_"|"_data4.getCol(4)_"|"_ZRELDATE
			do io4.write(ZDATA4)	
			
			}
		
		
         	type RecordTMPRPT3 rptext = Db.getRecord("TMPRPT3","PID='CNTEXT',ZBOO,ZTYP,ZSTAT",1)
         	set ZTMPDATA.piece("|",1) = rptext.DATA.piece("|",1)+1
		set ZTMPDATA.piece("|",2) = rptext.DATA.piece("|",2)+ZAMT
         	set rptext.DATA		  = ZTMPDATA
         	
         	do rptext.save()         	         	    	
         	
		do io1.write(ZDATA1)
		}
	
	do io1.close()
	do io2.close()
	do io3.close()
	do io4.close()
	
	quit

ZMKWRITE(IO io,String str)
	
	//Prevent end of line problem
	while (str.length()>80) do {
			
			set ztmp = str.extract(1,80)
			do io.write(ztmp)
			set str	= str.extract(81,str.length())
		
		}
		
		do io.write(str)
	
	quit
	
ZRPT()	
	do SYSVAR^SCADRV0()
	set ZRPT1="ZRPT1"
	set ZRPT2="CNTEXT"
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZCBSRPT1_"_TJD_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "BOO"_"|"_"COLTYP"_"|"_"COLSUBT"_"|"_"BOTCODE"_"|"_"SUBBOTCODE"_"|"_"SUBBOTDESC"_"|"_"SUMCOL"_"|"_"SUMCOLAMT"
	do io1.write(tWRITE)
	
	type ResultSet rs1 = Db.select("KEY1,KEY2,KEY3,KEY4,KEY5,KEY6,DATA","TMPRPT6","PID=:ZRPT1")
	while rs1.next() do {
		set tWRITE = rs1.getCol(1)_"|"_rs1.getCol(2)_"|"_rs1.getCol(3)_"|"_rs1.getCol(4)_"|"_rs1.getCol(5)_"|"_rs1.getCol(6)_"|"_rs1.getCol(7)
		do io1.write(tWRITE)
		}
	do io1.close()
	//type ResultSet rs1 = Db.select("PID,KEY1,KEY2,KEY3,DATA1,DATA2","ZCONVRPT")
	
	type IO io2=Class.new("IO")
	set io2.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZCBSRPT2_"_TJD_".TXT"
	set io2.openParams="NEWV/WRITE"
	do io2.open()
	set tWRITE = "BOO"_"|"_"CTRTYP"_"|"_"CTRSTATUS"_"|"_"SUMCTR"_"|"_"SUMCTRAMT"
	do io2.write(tWRITE)
	
	type ResultSet rs2 = Db.select("KEY1,KEY2,KEY3,DATA","TMPRPT3","PID=:ZRPT2")
	while rs2.next() do {
		set tWRITE = rs2.getCol(1)_"|"_rs2.getCol(2)_"|"_rs2.getCol(3)_"|"_rs2.getCol(4)
		do io2.write(tWRITE)
		}
	do io2.close()
	
	type IO io3=Class.new("IO")
	set io3.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZCBSRPT3_"_TJD_".TXT"
	set io3.openParams="NEWV/WRITE"
	do io3.open()
	set tWRITE = "BOO"_"|"_"CTRTYP"_"|"_"CTRSTATUS"_"|"_"PRODUCTTYP"_"|"_"SUMACCT"_"|"_"COLTYP"_"|"_"COLSUBT"_"|"_"SUMCOL"
	do io3.write(tWRITE)
	
	type ResultSet rs3 = Db.select("KEY1,KEY2,KEY3,KEY4,KEY5,KEY6,DATA","TMPRPT6","PID='ZRPT3'")
	while rs3.next() do {
			set tWRITE = rs3.getCol(1)_"|"_rs3.getCol(2)_"|"_rs3.getCol(3)_"|"_rs3.getCol(4)_"|"_rs3.getCol(5)_"|"_rs3.getCol(6)_"|"_rs3.getCol(7)
			do io3.write(tWRITE)
		}
	
	do io3.close()
	

	quit

TEST(input)
	set ZTAB=$C(9)
	set ZENTER=$C(13)
	set ZPROBLEM=$C(10)
	
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"TESTZCOL.TXT"
	set io1.recordSize = 1024
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	//set tWRITE = "BOO"_"|"_"COLTYP"_"|"_"COLSUBT"_"|"_"BOTCODE"_"|"_"SUBBOTCODE"_"|"_"SUBBOTDESC"_"|"_"SUMCOL"_"|"_"SUMCOLAMT"
	//do io1.write(tWRITE)
	set i=0
	while i<100 do {
				
		set ZDATA=^TMP("ZCONVCOL",input+i)
		if ZDATA[ZENTER set ZDATA=$TR(ZDATA,ZENTER," ")
		if ZDATA[ZTAB set ZDATA=$TR(ZDATA,ZTAB," ")
		if ZDATA[ZPROBLEM set ZDATA=$TR(ZDATA,ZPROBLEM," ")
		if ZDATA[$C(34) set ZDATA=$TR(ZDATA,$C(34)," ")
		do io1.write(ZDATA)
		set i=i+1	
		
		}
	do io1.close()
	quit
	