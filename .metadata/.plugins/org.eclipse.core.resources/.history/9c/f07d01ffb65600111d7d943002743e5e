//DO NOT MODIFY  Extract data to Table - ZUTBLSDISTCD|ZSDISTCD|||||||1
  /*
ORIG: srongkas - 09/21/2006
DESC: Extract data to Table - ZUTBLSDISTCD

---- Comments --------------------------------------------------------

---- Revision History ------------------------------------------------
	
	21-Sep-2006 : Supanee R. 
	              Coding program - Load File ZSDISTCD.TXT to ZUTBLSDISTCD
	              Function : ZSDISTCD 
	
 ****** Consider using setAuditFlag for all objects in this procedure
   example :do dep.setAuditFlag(1)

 */
	do Db.fastDelete("ZUTBLSDISTCD")						
	new ZFID,REC,ZOUT
	set (ZOUT,ER)=0
	catch error {
		new ET,RM
		set ET=error.type
		set RM=error.description
		set FROM=error.thrownAt
		do EXC
	}

	// Load File ZSDISTCD.TXT to ZUTBLSDISTCD
	set ZFID=$$TRNLNM^%ZFUNC("PROFILE_DIR")_"/spool/ZSDISTCD.TXT"
	// Check whether the file exists or not.
	do CHKIO(ZFID)
	if ER=1 set RM=$$^MSG(2799,ZFID) do EXC quit

	type IO io=Class.new("IO")
	set io.fileName=ZFID
	set io.openParams="READ"
	// set io.recordSize=256
	do io.open()

	for  set REC=io.read() quit:+ETYP'=0  do {
		// set value to variable		
		set ZCNTRY=$P(REC,$C(9),1)
		set ZSTATE=$P(REC,$C(9),2)
		set ZDIST=$P(REC,$C(9),3)
		set ZSUBDIST=$P(REC,$C(9),4)	
		set ZDESC=$P(REC,$C(9),5)

		type RecordZUTBLSDISTCD zsdistcd=Class.new("RecordZUTBLSDISTCD")
		// set data to table
		set zsdistcd.cntry=ZCNTRY
		set zsdistcd.state=ZSTATE
		set zsdistcd.dist=ZDIST
		set zsdistcd.subdist=ZSUBDIST
		set zsdistcd.desc=ZDESC

		do zsdistcd.bypassSave()

	}
	set IOTYP="RMS"
	do io.close()

	quit

CHKIO(X)
	// CHECK WHETHER THE FILE EXISTS OR NOT
	set z=$$FILE^%ZOPEN(X,"READ",5)
	if 'z do {
		set ER=1
		set RM=$P(z,"|",2)
	}
	close X

	quit

DELFILE(INFILE)

	new DELCMD
	set DELCMD="rm "_INFILE_";"
	set X=$$SYS^%ZFUNC(DELCMD)
	quit


EXC	//	LOG ERROR TO DAYEND
	if $G(DESC)="" set DESC="Create table from CRP (NPL)"
	if $G(RM)="" set RM=$G(ET)
	do LOG^UTLEXC($T(+0),"*",DESC,$G(ZECID),$G(ZETSEQ),$G(RM))
	kill ET,ZETSEQ,ZECID
	quit