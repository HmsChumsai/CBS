//DO NOT MODIFY  Extract Master Table From CBS-LOR|ZLOREXTR|||||||1

 	/*
ORIG: Ravipong Chumsai Na Ayuthaya  - 08/05/2012
DESC: Extract Master Table From CBS-LOR
	*/
	
	quit
	
EXTRACTALL

	do SYSVAR^SCADRV0()
	do AGENT
	do ARRPUR
	do CC
	do CCNTR
	do CNTRY
	do CNTRY1
	do COMLINE
	do CRCD
	do DIST
	do DISTCD
	do DOB
	do EDUC
	do EFTINST
	do HRC
	do IC
	do ID
	do ISICGC
	do ISICSD
	do ISICTS
	do LNAPASHLD
	do LNAPESTYP
	do LNAPRSTAT
	do LNAPRTYP
	do LOC
	do MF
	do MINISTRY1
	do MINISTRY2
	do MINISTRY3
	do MOU
	do MS
	do NATION
	do PERCONS
	do RELIGION
	do RPAYMETH
	do SDISTCD
	do SMECD
	do SOC
	do SPLEND 
	do STATD
	do STBLBUSOPT
	do STBLCLS
	do STBLCNTRY
	do STBLCNTRY1
	do TITLE
	do UHHOLD
	do ZUTBLLNAPESOWN
	
	quit



CCNTR

	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"UTBLCCNTR_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "COST_CENTER_ID"_"|"_"DESCRIPTION"_"|"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("UTBLCCNTR")
	while ds.next() do {
		type String output
		set i=i+1
		set output=""
		set output.piece("|",1) = ds.getRecord().CC
		set output.piece("|",2) = ds.getRecord().DESC_"|"
		do io1.write(output)
		}
	do io1.write(i_"|")
	do io1.close()
	quit
	
CNTRY	
	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"STBLCNTRY_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "COUNT_CODE"_"|"_"DESCRIPTION"_"|"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("STBLCNTRY")
	while ds.next() do {
		
		type String output
		set i=i+1
		set output.piece("|",1) = ds.getRecord().CNTRY
		set output.piece("|",2) = ds.getRecord().DESC_"|"
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()			
	quit
	

DISTCD
	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZUTBLSDISTCD_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "COUNTRY_CODE|PROVINCE_CODE|DISTRICT_CODE|SUB_DISTRICT_CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("ZUTBLSDISTCD")
	while ds.next() do {
		
		type String output
		set i=i+1		
		set output.piece("|",1) = ds.getRecord().CNTRY
		set output.piece("|",2) = ds.getRecord().STATE
		set output.piece("|",3) = ds.getRecord().DIST
		set output.piece("|",4) = ds.getRecord().SUBDIST
		set output.piece("|",5) = ds.getRecord().DESC
		set output.piece("|",6) = ""
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()	
		
	quit


CNTRY1	
	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"STBLCNTRY1_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "CNTRY_CD"_"|"_"PROV_CD"_"|"_"PROV_NAME"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("STBLCNTRY1")
	while ds.next() do {
		set i=i+1
		type String output
		set output.piece("|",1) = ds.getRecord().CNTRY
		set output.piece("|",2) = ds.getRecord().STATE
		set output.piece("|",3) = ds.getRecord().DESC
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()	
		
	quit



	
STATD

	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZUTBLSTATD_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("ZUTBLSTATD")
	while ds.next() do {
		set i=i+1
		type String output
		set output.piece("|",1) = ds.getRecord().ZSTATCD
		set output.piece("|",2) = ds.getRecord().DES_"|"
		do io1.write(output)
		}
	do io1.write(i_"|")	
		
		
	quit

HRC

	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"UTBLHRC_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("UTBLHRC")
	while ds.next() do {
		set i=i+1
		type String output
		set output.piece("|",1) = ds.getRecord().HRCODE		
		set output.piece("|",2) = ds.getRecord().HRCDESC_"|"
		set output.piece("|",2) = ds.getRecord().FMDESC_"|"
		do io1.write(output)
		}
	do io1.write(i_"|")	
		
UHHOLD		
	quit
	
	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"UHHOLD_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("UHHOLD")
	while ds.next() do {
		set i=i+1
		type String output
		set output.piece("|",1) = ds.getRecord().KEY	
		set output.piece("|",2) = ds.getRecord().DESC
		set output.piece("|",2) = ds.getRecord().FMDESC_"|"
		do io1.write(output)
		}
	do io1.write(i_"|")	
		
		
	quit

AGENT
	
	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"AGENT_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "CODE|DESC_TH|DESC_EN|ASSIGNED_BRANCH_CODE|OWNER_BRANCH_CODE|MOU_UNIT_CODE"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("AGENT")
	while ds.next() do {
		set i=i+1
		type String output
		set output.piece("|",1) = ds.getRecord().AGENT
		set output.piece("|",2) = ds.getRecord().ZAGNAME
		set output.piece("|",3) = ""
		set output.piece("|",4) = ds.getRecord().ZABRCD
		set output.piece("|",5) = ds.getRecord().ZOBRCD
		set output.piece("|",6) = ds.getRecord().ZMOU
		do io1.write(output)
		}
	do io1.write(i_"|")	
		
		
	quit
	

LNAPASHLD
	
	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZUTBLLNAPASHLD_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("ZUTBLLNAPASHLD")
	while ds.next() do {
		set i=i+1
		type String output
		set output.piece("|",1) = ds.getRecord().CODE
		set output.piece("|",2) = ds.getRecord().DESC_"|"
		do io1.write(output)
		}
	do io1.write(i_"|")	
		
		
	quit
	
EFTINST	
	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"UTBLEFTINST_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("UTBLEFTINST")
	while ds.next() do {
		set i=i+1
		type String output
		set output.piece("|",1) = ds.getRecord().KEY
		set output.piece("|",2) = ds.getRecord().NAM
		set output.piece("|",3) = ds.getRecord().FMDESC_"|"
		do io1.write(output)
		}
	do io1.write(i_"|")	
		
		
	quit
	
DOB	
	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZUTBLDOB_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("ZUTBLDOB")
	while ds.next() do {
		set i=i+1
		type String output
		set output.piece("|",1) = ds.getRecord().ZDOBCD
		set output.piece("|",2) = ds.getRecord().DESC_"|"
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()	
		
	quit
	
ZUTBLLNAPESOWN
	
	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZUTBLLNAPESOWN_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("ZUTBLLNAPESOWN")
	while ds.next() do {
		set i=i+1
		type String output
		set output.piece("|",1) = ds.getRecord().CODE
		set output.piece("|",2) = ds.getRecord().DESC_"|"
		do io1.write(output)
		}
	do io1.write(i_"|")	
		
	do io1.close()	
	quit
	
LNAPESTYP

	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZUTBLLNAPESTYP_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("ZUTBLLNAPESTYP")
	while ds.next() do {
		set i=i+1
		type String output
		set output.piece("|",1) = ds.getRecord().CODE
		set output.piece("|",2) = ds.getRecord().DESC_"|"
		do io1.write(output)
		}
	do io1.write(i_"|")	
		
	do io1.close()	
	quit
	
	
COMLINE
	
	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZUTBLCOMLINE_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("ZUTBLCOMLINE")
	while ds.next() do {
		set i=i+1
		type String output
		set output.piece("|",1) = ds.getRecord().COMLINE
		set output.piece("|",2) = ds.getRecord().DES_"|"
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()	
	
	quit
	
STBLCNTRY

	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"STBLCNTRY_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("STBLCNTRY")
	while ds.next() do {
		set i=i+1
		type String output
		set output.piece("|",1) = ds.getRecord().CNTRY
		set output.piece("|",2) = ds.getRecord().DESC
		set output.piece("|",3) = ds.getRecord().FMDESC_"|"
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()	
		
	quit
	
STBLCNTRY1
	
	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"STBLCNTRY1_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "COUNTRY_CODE|PROVINCE_CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("STBLCNTRY1")
	while ds.next() do {
		set i=i+1
		type String output
		set output.piece("|",1) = ds.getRecord().CNTRY
		set output.piece("|",2) = ds.getRecord().STATE	
		set output.piece("|",3) = ds.getRecord().DESC
		set output.piece("|",4) = ds.getRecord().FMDESC_"|"
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()	
		
	quit
	
DIST
	
	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZUTBLDIST_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "COUNTRY_CODE|PROVINCE_CODE|DISTRICT_CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("ZUTBLDIST")
	while ds.next() do {
		set i=i+1
		type String output
		set output.piece("|",1) = ds.getRecord().CNTRY
		set output.piece("|",2) = ds.getRecord().STATE	
		set output.piece("|",3) = ds.getRecord().DIST
		set output.piece("|",4) = ds.getRecord().DES_"|"
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()	
		
	quit
	
SDISTCD

	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZUTBLSDISTCD_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "COUNTRY_CODE|PROVINCE_CODE|DISTRICT_CODE|SUB_DISTRICT_CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("ZUTBLSDISTCD")
	while ds.next() do {
		set i=i+1
		type String output
		set output.piece("|",1) = ds.getRecord().CNTRY
		set output.piece("|",2) = ds.getRecord().STATE	
		set output.piece("|",3) = ds.getRecord().DIST
		set output.piece("|",4) = ds.getRecord().SUBDIST_"|"
		set output.piece("|",4) = ds.getRecord().DESC_"|"
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()	
		
	quit
CRCD
	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"CRCD_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("CRCD","CO='GSB'")
	while ds.next() do {
		type String output
		set i=i+1
		set output=""
		set output.piece("|",1) = ds.getRecord().CRCD
		set output.piece("|",2) = ds.getRecord().DESC_"|"
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()	
		
	quit

CC	
	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"UTBLCC_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("UTBLCC")
	while ds.next() do {
		type String output
		set i=i+1
		set output=""
		set output.piece("|",1) = ds.getRecord().CCODE
		set output.piece("|",2) = ds.getRecord().DESC_"|"
		set output.piece("|",3) = ds.getRecord().FMDESC_"|"
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()
	quit
		
EDUC
	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"UTBLEDUC_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("UTBLEDUC")
	while ds.next() do {
		type String output
		set i=i+1
		set output.piece("|",1) = ds.getRecord().EDUC
		set output.piece("|",2) = ds.getRecord().DESC
		set output.piece("|",3) = ds.getRecord().FMDESC_"|"
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()	
		
	quit

LNAPRTYP
	
	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZUTBLLNAPRTYP_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("ZUTBLLNAPRTYP")
	while ds.next() do {
		type String output
		set i=i+1
		set output.piece("|",1) = ds.getRecord().CODE
		set output.piece("|",2) = ds.getRecord().DESC_"|"
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()	
		
	quit
	
ID	
	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"UTBLID_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("UTBLID")
	while ds.next() do {
		type String output
		set i=i+1
		set output.piece("|",1) = ds.getRecord().IDTYP
		set output.piece("|",2) = ds.getRecord().DES
		set output.piece("|",3) = ds.getRecord().FMDESC_"|"
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()	
		
	quit
	
IC

	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"UTBLIC_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("UTBLIC")
	while ds.next() do {
		type String output
		set i=i+1
		set output.piece("|",1) = ds.getRecord().INC
		set output.piece("|",2) = ds.getRecord().DESC
		set output.piece("|",3) = ds.getRecord().FMDESC_"|"
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()	
		
	quit
	
ISICSD	
	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZUTBLISICSD_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "ISIC_1_CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("ZUTBLISICSD")
	while ds.next() do {
		type String output
		set i=i+1
		set output.piece("|",1) = ds.getRecord().ISICSD
		set output.piece("|",2) = ds.getRecord().TDES
		set output.piece("|",3) = ds.getRecord().DES_"|"
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()	
		
	quit
	
ISICGC
	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZUTBLISICGC_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "ISIC_1_CODE|ISIC_2_CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("ZUTBLISICGC")
	while ds.next() do {
		type String output
		set i=i+1
		set output.piece("|",1) = ds.getRecord().ISICSD
		set output.piece("|",2) = ds.getRecord().ISICGC
		set output.piece("|",3) = ds.getRecord().TDES
		set output.piece("|",4) = ds.getRecord().DES_"|"
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()	
		
	quit
	
ISICTS

	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZUTBLISICTS_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "ISIC_1_CODE|ISIC_2_CODE|ISIC_3_CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("ZUTBLISICTS")
	while ds.next() do {
		type String output
		set i=i+1
		set output.piece("|",1) = ds.getRecord().ISICSD
		set output.piece("|",2) = ds.getRecord().ISICGC
		set output.piece("|",3) = ds.getRecord().ISICTS
		set output.piece("|",4) = ds.getRecord().TDES
		set output.piece("|",5) = ds.getRecord().DES_"|"
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()	
		
	quit
	
	
LNAPRSTAT	

	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZUTBLLNAPRSTAT_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("ZUTBLLNAPRSTAT")
	while ds.next() do {
		type String output
		set i=i+1
		set output.piece("|",1) = ds.getRecord().CODE
		set output.piece("|",2) = ds.getRecord().DESC
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()	
		
	quit
	
MF

	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"UTBLMF_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("UTBLMF")
	while ds.next() do {
		type String output
		set i=i+1
		set output.piece("|",1) = ds.getRecord().MF
		set output.piece("|",2) = ds.getRecord().DESC
		set output.piece("|",3) = ds.getRecord().FMDESC_"|"
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()	
		
	quit
	
MS

	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"UTBLMS_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("UTBLMS")
	while ds.next() do {
		type String output
		set i=i+1
		set output.piece("|",1) = ds.getRecord().MAR
		set output.piece("|",2) = ds.getRecord().DESC
		set output.piece("|",3) = ds.getRecord().FMDESC_"|"
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()	
		
	quit
	
MINISTRY1

	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZUTBLMINISTRY1_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "MINISTRY_1_CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("ZUTBLMINISTRY1")
	while ds.next() do {
		type String output
		set i=i+1
		set output.piece("|",1) = ds.getRecord().ZMINISTRYCD1
		set output.piece("|",2) = ds.getRecord().DESC
		set output.piece("|",3) = ""
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()	
		
	quit
	
MINISTRY2

	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZUTBLMINISTRY2_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "MINISTRY_2_CODE|MINISTRY_1_CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("ZUTBLMINISTRY2")
	while ds.next() do {
		type String output
		set i=i+1
		set output.piece("|",1) = ds.getRecord().ZMINISTRYCD2
		set output.piece("|",2) = ds.getRecord().ZMINISTRYCD1
		set output.piece("|",3) = ds.getRecord().DESC
		set output.piece("|",4) = ""
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()	
		
	quit
	
MINISTRY3

	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZUTBLMINISTRY3_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "MINISTRY_3_CODE|MINISTRY_2_CODE|DESC_TH|DESC_EN|MINISTRY_1_CODE"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("ZUTBLMINISTRY3")
	while ds.next() do {
		type String output
		set i=i+1
		set output.piece("|",1) = ds.getRecord().ZMINISTRYCD3
		set output.piece("|",2) = ds.getRecord().ZMINISTRYCD2
		set output.piece("|",3) = ds.getRecord().DESC
		set output.piece("|",4) = ""
		set output.piece("|",5) = ds.getRecord().ZMINISTRYCD1
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()	
		
	quit
	
MOU	

	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZUTBLMOU_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("ZUTBLMOU")
	while ds.next() do {
		type String output
		set i=i+1
		set output.piece("|",1) = ds.getRecord().CODE
		set output.piece("|",2) = ds.getRecord().DESC
		set output.piece("|",3) = ""
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()	
		
	quit
	
NATION
	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZUTBLNATION_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("ZUTBLNATION")
	while ds.next() do {
		type String output
		set i=i+1
		set output.piece("|",1) = ds.getRecord().NATCD
		set output.piece("|",2) = ds.getRecord().TDES
		set output.piece("|",3) = ds.getRecord().DESC
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()	
		
	quit

LOC
	
	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZUTBLOC_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "OCCUPATION_CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("ZUTBLOC")
	while ds.next() do {
		type String output
		set i=i+1
		set output.piece("|",1) = ds.getRecord().OCC
		set output.piece("|",2) = ds.getRecord().ABBR
		set output.piece("|",3) = ds.getRecord().TDES
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()	
		
	quit

SOC

	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZUTBLSOC_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "OCCUPATION_CODE|SUB_OCCUPATION_CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("ZUTBLSOC")
	while ds.next() do {
		type String output
		set i=i+1
		set output.piece("|",1) = ds.getRecord().OCC
		set output.piece("|",2) = ds.getRecord().SOCC
		set output.piece("|",3) = ds.getRecord().TDES
		set output.piece("|",4) = ds.getRecord().DES
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()	
		
	quit

RPAYMETH

	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZUTBLRPAYMETH_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "CODE|DESC_TH|DESC_EN|AGENT_FLAG"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("ZUTBLRPAYMETH")
	while ds.next() do {
		type String output
		set i=i+1
		set output.piece("|",1) = ds.getRecord().CODE
		set output.piece("|",2) = ds.getRecord().DESC
		set output.piece("|",3) = ""
		set output.piece("|",4) = ds.getRecord().ZAGENT
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()		
	quit
	
STBLBUSOPT

	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"STBLBUSOPT_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "CODE|DESC_TH|DESC_EN|"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("STBLBUSOPT")
	while ds.next() do {
		type String output
		set i=i+1
		set output.piece("|",1) = ds.getRecord().BD
		set output.piece("|",2) = ds.getRecord().DESC
		set output.piece("|",3) = ""
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()		
	quit
	
PERCONS

	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZUTBLPERCONS_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "CODE|DESC_TH|DESC_EN|PRODUCT_TYPE_CODE"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("ZUTBLPERCONS")
	while ds.next() do {
		type String output
		set i=i+1
		set output.piece("|",1) = ds.getRecord().CODE
		set output.piece("|",2) = ds.getRecord().DESC
		set output.piece("|",3) = ""
		set output.piece("|",4) = ds.getRecord().TYPE
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()		
	quit
	
STBLCLS

	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"STBLCLS_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "CODE|DESC_TH|DESC_EN|"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("STBLCLS")
	while ds.next() do {
		type String output
		set i=i+1
		set output.piece("|",1) = ds.getRecord().CLS
		set output.piece("|",2) = ds.getRecord().DES
		set output.piece("|",3) = ""
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()		
	quit

ARRPUR	
	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZUTBLARRPUR_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "PURPOSE_ARRANGEMENT_CODE|DESC_TH|DESC_EN|PRODUCT_GROUP_CODE"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("ZUTBLARRPUR")
	while ds.next() do {
		type String output
		set i=i+1
		set output.piece("|",1) = ds.getRecord().CODE
		set output.piece("|",2) = ds.getRecord().DESC
		set output.piece("|",3) = ""
		set output.piece("|",4) = ds.getRecord().GRP
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()		
	quit

RELIGION
	
	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZUTBLRELIGION_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("ZUTBLRELIGION")
	while ds.next() do {
		type String output
		set i=i+1
		set output.piece("|",1) = ds.getRecord().ZRELIGIONCD
		set output.piece("|",2) = ds.getRecord().DESC
		set output.piece("|",3) = ""
		//set output.piece("|",4) = ds.getRecord().GRP
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()		
	quit
	
SPLEND	

	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZUTBLSPLEND_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("ZUTBLSPLEND")
	while ds.next() do {
		type String output
		set i=i+1
		set output.piece("|",1) = ds.getRecord().CODE
		set output.piece("|",2) = ds.getRecord().DESC
		set output.piece("|",3) = ""
		//set output.piece("|",4) = ds.getRecord().GRP
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()		
	quit

SMECD
	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZUTBLSMECD_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "CODE|DESC_TH|DESC_EN"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("ZUTBLSMECD")
	while ds.next() do {
		type String output
		set i=i+1
		set output.piece("|",1) = ds.getRecord().CODE
		set output.piece("|",2) = ds.getRecord().DESC
		set output.piece("|",3) = ""
		//set output.piece("|",4) = ds.getRecord().GRP
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()		
	quit
	
TITLE
	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"ZUTBLTITLE_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "CODE|DESC_TH|DESC_EN|TYPE"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("ZUTBLTITLE")
	while ds.next() do {
		type String output
		set i=i+1
		set output.piece("|",1) = ds.getRecord().TITLECD
		set output.piece("|",2) = ds.getRecord().DESC
		set output.piece("|",3) = ds.getRecord().PERSFLG
		set output.piece("|",4) = ds.getRecord().ENGFLG
		do io1.write(output)
		}
	do io1.write(i_"|")	
	do io1.close()
			
	quit
	
BRCD
	
	
	type String tWRITE
	set ZEXTDAT = $$DAT^%ZM(TJD,"YEARMMDD")
	type IO io1=Class.new("IO")
	set io1.fileName=$$TRNLNM^%ZFUNC("SCAU_SPOOL_EXTF")_"/"_"UTBLBRCD_"_ZEXTDAT_".TXT"
	set io1.openParams="NEWV/WRITE"
	do io1.open()
	set tWRITE = "BRANCH_ID"_"|"_"DESCRIPTION"_"|"_"DEFAULT_COSTCENTER"
	do io1.write(tWRITE)
	set i=0
	type DbSet ds = Db.selectDbSet("UTBLBRCD")
	while ds.next() do {
		set i=i+1
		set output=""
		set output.piece("|",1) = ds.getRecord().BRCD
		set output.piece("|",2) = ds.getRecord().DESC
		set output.piece("|",3) = ds.getRecord().CCDEF_"|"
		do io1.write(output)
		}
	do io1.write(i_"|")
	do io1.close()
			
	quit
	
	
	
	
	
	

	
	





	